

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pivotpy.i_plots &mdash; pivotpy 0.9.9 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> pivotpy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Pivotpy API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pivotpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>pivotpy.i_plots</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pivotpy.i_plots</h1><div class="highlight"><pre>
<span></span><span class="c1"># AUTOGENERATED! DO NOT EDIT! File to edit: InteractivePlots.ipynb (unless otherwise specified).</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;get_rgb_data&#39;</span><span class="p">,</span> <span class="s1">&#39;flip_even_patches&#39;</span><span class="p">,</span> <span class="s1">&#39;rgb_to_plotly&#39;</span><span class="p">,</span> <span class="s1">&#39;plotly_to_html&#39;</span><span class="p">,</span> <span class="s1">&#39;plotly_rgb_lines&#39;</span><span class="p">,</span>
           <span class="s1">&#39;plotly_dos_lines&#39;</span><span class="p">]</span>

<span class="c1"># Cell</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="kn">import</span> <span class="nn">pivotpy.vr_parser</span> <span class="k">as</span> <span class="nn">vp</span>
<span class="kn">import</span> <span class="nn">pivotpy.s_plots</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">pivotpy.g_utils</span> <span class="k">as</span> <span class="nn">gu</span>

<span class="c1"># Cell</span>
<span class="k">def</span> <span class="nf">get_rgb_data</span><span class="p">(</span>   <span class="n">kpath</span>       <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">evals_set</span>   <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">pros_set</span>    <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">elements</span>    <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">],[],[]],</span>
                    <span class="n">orbs</span>        <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">],[],[]],</span>
                    <span class="n">interpolate</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="n">n</span>           <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
                    <span class="n">k</span>           <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                    <span class="n">scale_color</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - Returns a formatted RGB colored data to pass into `rgb_to_plotly` function. Two arguments, `elements` and `orbs` should be in one-to-one correspondence. Returned item has transpose data shape, so that main iteration is over bands.</span>
<span class="sd">    - **Parameters**</span>
<span class="sd">        - ax       : Matplotlib axes object, if not given, linecollection is returned.</span>
<span class="sd">        - kapath   : `export_vasprun`().kpath or `get_kpts`().kpath.</span>
<span class="sd">        - evals_set: `export_vasprun`().bands.evals or `get_evals`().evals. If calculations are spin-polarized, it will be `...evals.SpinUp/SpinDown` for both. You need to apply twice for SpinUp and SpinDown separately.</span>
<span class="sd">        - pros_set : `export_vasprun().pro_bands.pros` or `get_bands_pro_set`().pros. If calculations are spin-polarized, it will be `...pros.SpinUp/SpinDown` for both. You need to create collections twice for SpinUp and SpinDown separately.</span>
<span class="sd">        - elements : List three lists of ions to project on, each element could be `range(start,stop,step)` as well, remember that `stop` is not included in python. so `range(0,2)` will generate 0 and 1 indices.</span>
<span class="sd">        - orbs     : List of three lists of orbitals indices. `[[red],[green],[blue]]`, you can create any color by this combination. For example, to get `s-orbital in yellow color`, you will use `[[0],[0],[]]`. Do not remove empty list from there, it will not effect your orbital selection.</span>
<span class="sd">        - interpolate: Deafult is false, if True, it will add n points between nearest kpoints.</span>
<span class="sd">        - n        : int, default is 5. Adds n points between nearest kpoints.</span>
<span class="sd">        - k        : int, order of interpolation, defualt is 3. `n &gt; k` should be hold.</span>
<span class="sd">        - scale_color: If True, colors are scaled to 1 at each points.</span>
<span class="sd">    - **Returns**</span>
<span class="sd">        - kpath    : List of NKPTS. (interpolated if given.)</span>
<span class="sd">        - evals    : An (NBAND,NKPTS) numpy arry.</span>
<span class="sd">        - colors   : An (NBANDS,NKPTS,3) numpy array.</span>
<span class="sd">        - widths   : An (NBAND,NKPTS) numpy arry, its actually colors summed along z-axis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">pros_set</span><span class="o">==</span><span class="p">[]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">gu</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="s2">&quot;Can not plot an empty eigenvalues object.&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="n">gu</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="s2">&quot;Try with large energy range.&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">orbs</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">3</span> <span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;orbs have structure [[],[],[]], do not reduce structure even if it is empty.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;elements have structure [[],[],[]], do not reduce structure even if it is empty.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">pros_set</span><span class="p">,</span><span class="n">orbs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
       <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
       <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">pros_set</span><span class="p">,</span><span class="n">orbs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
       <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
       <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">pros_set</span><span class="p">,</span><span class="n">orbs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
       <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
       <span class="k">if</span><span class="p">(</span><span class="n">interpolate</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
           <span class="kn">from</span> <span class="nn">pivotpy</span> <span class="kn">import</span> <span class="n">g_utils</span> <span class="k">as</span> <span class="n">gu</span>
           <span class="n">knew</span><span class="p">,</span><span class="n">evals</span> <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">interpolate_data</span><span class="p">(</span><span class="n">kpath</span><span class="p">,</span><span class="n">evals_set</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
           <span class="n">r</span>  <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">interpolate_data</span><span class="p">(</span><span class="n">kpath</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
           <span class="n">g</span>  <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">interpolate_data</span><span class="p">(</span><span class="n">kpath</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
           <span class="n">b</span>  <span class="o">=</span> <span class="n">gu</span><span class="o">.</span><span class="n">interpolate_data</span><span class="p">(</span><span class="n">kpath</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
       <span class="k">else</span><span class="p">:</span>
           <span class="n">knew</span><span class="p">,</span><span class="n">evals</span> <span class="o">=</span> <span class="n">kpath</span><span class="p">,</span><span class="n">evals_set</span>
       <span class="n">evals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">evals</span><span class="p">)</span>
       <span class="n">max_c</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">max</span><span class="p">,</span><span class="n">r</span><span class="p">[:,:])),</span><span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">max</span><span class="p">,</span><span class="n">g</span><span class="p">[:,:])),</span><span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">max</span><span class="p">,</span><span class="n">b</span><span class="p">[:,:])))</span>
       <span class="k">if</span><span class="p">(</span><span class="n">max_c</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
           <span class="n">max_c</span><span class="o">=</span><span class="mi">1</span> <span class="c1"># Avoid divide by 0.</span>
       <span class="n">_cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">r</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">r</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
       <span class="n">rgb</span> <span class="o">=</span> <span class="n">_cl</span><span class="o">/</span><span class="n">max_c</span> <span class="c1"># Normalized overall</span>
       <span class="n">widths</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#should be before scale colors</span>
       <span class="k">if</span><span class="p">(</span><span class="n">scale_color</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
           <span class="n">cl_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">_cl</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
           <span class="c1"># avoid divide by zero. Contributions are 4 digits only.</span>
           <span class="n">cl_max</span><span class="p">[</span><span class="n">cl_max</span><span class="o">==</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="n">rgb</span> <span class="o">=</span> <span class="n">_cl</span><span class="o">/</span><span class="n">cl_max</span><span class="p">[:,:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="c1"># Normalized per point</span>
       <span class="k">return</span> <span class="n">knew</span><span class="p">,</span><span class="n">evals</span><span class="p">,</span><span class="n">rgb</span><span class="p">,</span> <span class="n">widths</span>

<span class="c1"># Cell</span>
<span class="k">def</span> <span class="nf">flip_even_patches</span><span class="p">(</span><span class="n">array_1d</span><span class="p">,</span> <span class="n">patch_length</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - When you reshape bands data to 1D array, you may need to draw lines which do not link ends of plot, for that, it is required to flip patches, so that next band start from where 1st end and so one.</span>
<span class="sd">    - **Parameters**</span>
<span class="sd">        - array_1d     : Numpy 1d array or list.</span>
<span class="sd">        - patch_length : length of xaxis patches, e.g NKPTS.</span>
<span class="sd">    - **Returns**</span>
<span class="sd">        - 1D list</span>
<span class="sd">    - ** Example**</span>
<span class="sd">        &gt; k=[1,2,3,1,2,3]</span>
<span class="sd">        &gt; flip_even_patches(k,3)</span>
<span class="sd">        &gt; [1,2,3,3,2,1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out_put</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n</span><span class="o">=</span> <span class="n">patch_length</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array_1d</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out_put</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">array_1d</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">n</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out_put</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">array_1d</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">n</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">out_put</span>

<span class="c1"># Cell</span>
<span class="k">def</span> <span class="nf">rgb_to_plotly</span><span class="p">(</span><span class="n">rgb_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span><span class="n">max_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">symbol</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - Returns data object of plotly&#39;s figure using `get_rgb_data`. Returned data could be fed to a plolty&#39;s figure.</span>
<span class="sd">    - ** Parameters**</span>
<span class="sd">        - rgb_data    : output of `get_rgb_data`.</span>
<span class="sd">        - mode        : Three plotting modes are available:</span>
<span class="sd">            - &#39;markers&#39; : Plot whole data as a single scatter object. Its too fast.</span>
<span class="sd">            - &#39;bands&#39;   : Plot data such that each band is accessible via legend.</span>
<span class="sd">            - &#39;lines&#39;   : A replica of `matplotlib LineCollection` object. It plots at each point separately, slower than other two modes.</span>
<span class="sd">        - max_width  : Line/Scatter thickness is scaled to `max_width`. None by default and represent actual data.</span>
<span class="sd">        - name       : Name to be shown on hover text or legend.</span>
<span class="sd">        - labels     : Optional, show red green blue colors corresponding orbitals.</span>
<span class="sd">        - showlegend : Optional, only suitbale if spin up/down or &#39;bands&#39; mode is ON.</span>
<span class="sd">        - symbol     : Plotly&#39;s marker symbol. 0 for circle, 5/6 for Up/Down.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span><span class="s1">&#39;bands&#39;</span><span class="p">,</span><span class="s1">&#39;lines&#39;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument `mode` expects one of [&#39;markers&#39;,&#39;bands&#39;,&#39;lines&#39;], got &#39;</span><span class="si">{}</span><span class="s2">&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">rgb_data</span><span class="p">:</span>
        <span class="n">k</span><span class="p">,</span><span class="n">en</span><span class="p">,</span><span class="n">rgb</span><span class="p">,</span><span class="n">lws</span> <span class="o">=</span> <span class="n">rgb_data</span>

        <span class="n">_names</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;&lt;sub&gt;</span><span class="si">{}</span><span class="s2">&lt;/sub&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">en</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span>
                  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">en</span><span class="p">))]</span>
        <span class="n">clrs</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">rgb</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span> <span class="c1">#clip in color range</span>
        <span class="n">_txt</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">rgb</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">colors</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;rgb(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_c</span><span class="p">]</span> <span class="k">for</span> <span class="n">_c</span> <span class="ow">in</span> <span class="n">clrs</span><span class="p">]</span>
        <span class="n">txts</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;RGB(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_t</span><span class="p">]</span> <span class="k">for</span> <span class="n">_t</span> <span class="ow">in</span> <span class="n">_txt</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">max_width</span><span class="p">:</span>
            <span class="n">lws</span> <span class="o">=</span> <span class="n">max_width</span><span class="o">*</span><span class="n">lws</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lws</span><span class="p">)</span>

        <span class="n">h_template</span> <span class="o">=</span> <span class="s2">&quot;Proj: </span><span class="si">{}</span><span class="s2"> &lt;br&gt;</span><span class="si">{}</span><span class="s2"> &lt;/br&gt;Band: </span><span class="si">{}{}</span><span class="s2">&quot;</span>
        <span class="n">h_text</span><span class="o">=</span><span class="p">[[</span><span class="n">h_template</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="o">*</span><span class="n">labels</span><span class="p">],</span><span class="n">t</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">ns</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">ts</span><span class="p">,</span><span class="n">ns</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">txts</span><span class="p">,</span><span class="n">_names</span><span class="p">)]</span>
        <span class="n">data</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span><span class="p">(</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;lines&#39;</span><span class="p">):</span>
            <span class="n">lc</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span><span class="n">ke</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ke</span> <span class="ow">in</span> <span class="n">en</span><span class="p">]</span>
            <span class="n">lws</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">lws</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">lws</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:])</span>
            <span class="c1"># Zip auto picks colors,lws,h_text in same number as en</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
             <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="p">),</span>
             <span class="n">showlegend</span><span class="o">=</span><span class="n">showlegend</span><span class="p">,</span><span class="n">hovertext</span><span class="o">=</span><span class="n">h</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">pts</span><span class="p">,</span><span class="n">cs</span><span class="p">,</span><span class="n">ws</span><span class="p">,</span><span class="n">hs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lc</span><span class="p">,</span><span class="n">colors</span><span class="p">,</span><span class="n">lws</span><span class="p">,</span><span class="n">h_text</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">pt</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span><span class="n">cs</span><span class="p">,</span><span class="n">ws</span><span class="p">,</span><span class="n">hs</span><span class="p">)]</span>

        <span class="k">if</span><span class="p">(</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;markers&#39;</span><span class="p">):</span>
            <span class="n">nkpts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="c1"># should not move up or down.</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">bands</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">en</span><span class="p">))]</span>
            <span class="n">k</span><span class="p">,</span><span class="n">en</span><span class="p">,</span><span class="n">colors</span><span class="p">,</span><span class="n">lws</span><span class="p">,</span><span class="n">h_text</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">item</span><span class="p">,(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">en</span><span class="p">,</span><span class="n">colors</span><span class="p">,</span><span class="n">lws</span><span class="p">,</span><span class="n">h_text</span><span class="p">]]</span>
            <span class="c1"># Make lines reverse at even line.</span>
            <span class="n">k</span><span class="p">,</span><span class="n">en</span><span class="p">,</span><span class="n">colors</span><span class="p">,</span><span class="n">lws</span><span class="p">,</span><span class="n">h_text</span> <span class="o">=</span><span class="p">[</span><span class="n">flip_even_patches</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">nkpts</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">en</span><span class="p">,</span><span class="n">colors</span><span class="p">,</span><span class="n">lws</span><span class="p">,</span><span class="n">h_text</span><span class="p">]]</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">k</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">en</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">lws</span><span class="p">,</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">),</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgba(255,255,250,0)&#39;</span><span class="p">),</span><span class="n">showlegend</span><span class="o">=</span><span class="n">showlegend</span><span class="p">,</span><span class="n">hovertext</span><span class="o">=</span><span class="n">h_text</span><span class="p">)</span>
                        <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;bands&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">values</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">colors</span><span class="p">,</span><span class="n">lws</span><span class="p">,</span><span class="n">h_text</span><span class="p">)):</span>
                <span class="n">e</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">values</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">k</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">e</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers+lines&#39;</span><span class="p">,</span>
                            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&lt;sub&gt;</span><span class="si">{}</span><span class="s2">&lt;/sub&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span>
                            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">),</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgba(255,255,250,0)&#39;</span><span class="p">),</span><span class="n">showlegend</span><span class="o">=</span><span class="n">showlegend</span><span class="p">,</span><span class="n">hovertext</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
                           <span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

<span class="c1"># Cell</span>
<div class="viewcode-block" id="plotly_to_html"><a class="viewcode-back" href="../../api.html#pivotpy.i_plots.plotly_to_html">[docs]</a><span class="k">def</span> <span class="nf">plotly_to_html</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">out_string</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">modebar</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - Writes plotly&#39;s figure as HTML file or display in IPython which is accessible when online. It is different than plotly&#39;s `fig.to_html` as it is minimal in memory. If you need to have offline working file, just use `fig.write_html(&#39;file.html&#39;)` which will be larger in size.</span>
<span class="sd">    - **Parameters**</span>
<span class="sd">        - fig      : A plotly&#39;s figure object.</span>
<span class="sd">        - filename : Name of file to save fig. Defualt is None and show plot in Colab/Online or return hrml string.</span>
<span class="sd">        - out_string: If True, returns HTML string, if False displays graph if possible.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">uuid</span> <span class="c1"># Unique div-id required,otherwise jupyterlab renders at one place only and overwite it.</span>
    <span class="n">div_id</span> <span class="o">=</span> <span class="s2">&quot;graph-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>
    <span class="n">fig_json</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
    <span class="c1"># a simple HTML template</span>
    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;html&gt;</span>
<span class="s2">        &lt;head&gt;</span>
<span class="s2">        &lt;script src=&quot;https://cdn.plot.ly/plotly-latest.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="s2">        &lt;/head&gt;</span>
<span class="s2">        &lt;body&gt;</span>
<span class="s2">            &lt;div id=&#39;</span><span class="si">{}</span><span class="s2">&#39;&gt;&lt;/div&gt;</span>
<span class="s2">            &lt;script&gt;</span>
<span class="s2">                var fig_data = </span><span class="si">{}</span><span class="s2"></span>
<span class="s2">                Plotly.react(&#39;</span><span class="si">{}</span><span class="s2">&#39;, fig_data.data, fig_data.layout);</span>
<span class="s2">            &lt;/script&gt;</span>
<span class="s2">        &lt;/body&gt;</span>
<span class="s2">        &lt;/html&gt;&quot;&quot;&quot;</span>

        <span class="c1"># write the JSON to the HTML template</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">div_id</span><span class="p">,</span><span class="n">fig_json</span><span class="p">,</span><span class="n">div_id</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">modebar</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span> <span class="c1">#Only for docs issue</span>
            <span class="n">config</span> <span class="o">=</span> <span class="s2">&quot;{displayModeBar: true,scrollZoom: true}&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="s2">&quot;{displayModeBar: false,scrollZoom: true}&quot;</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;div&gt;</span>
<span class="s2">        &lt;script src=&#39;https://cdn.plot.ly/plotly-latest.min.js&#39;&gt;&lt;/script&gt;</span>
<span class="s2">            &lt;div id=&#39;</span><span class="si">{}</span><span class="s2">&#39;&gt;&lt;!-- Plotly chart DIV --&gt;&lt;/div&gt;</span>
<span class="s2">            &lt;script&gt;</span>
<span class="s2">                var data = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">                var config = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">                Plotly.newPlot(&#39;</span><span class="si">{}</span><span class="s2">&#39;, data.data,data.layout,config);</span>
<span class="s2">            &lt;/script&gt;</span>
<span class="s2">        &lt;/div&gt;&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">div_id</span><span class="p">,</span><span class="n">fig_json</span><span class="p">,</span><span class="n">config</span><span class="p">,</span><span class="n">div_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">out_string</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">template</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
            <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">template</span><span class="p">)</span></div>

<span class="c1"># Cell</span>
<div class="viewcode-block" id="plotly_rgb_lines"><a class="viewcode-back" href="../../api.html#pivotpy.i_plots.plotly_rgb_lines">[docs]</a><span class="k">def</span> <span class="nf">plotly_rgb_lines</span><span class="p">(</span><span class="n">path_evr</span>    <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">elements</span>    <span class="o">=</span> <span class="p">[[],[],[]],</span>
                    <span class="n">orbs</span>        <span class="o">=</span> <span class="p">[[],[],[]],</span>
                    <span class="n">labels</span>      <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">],</span>
                    <span class="n">mode</span>        <span class="o">=</span> <span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                    <span class="n">elim</span>        <span class="o">=</span> <span class="p">[],</span>
                    <span class="n">E_Fermi</span>     <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">skipk</span>       <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">joinPathAt</span>  <span class="o">=</span> <span class="p">[],</span>
                    <span class="n">max_width</span>   <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
                    <span class="n">title</span>       <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">xt_indices</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">xt_labels</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Γ&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">],</span>
                    <span class="n">figsize</span>     <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">interpolate</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="n">n</span>           <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
                    <span class="n">k</span>           <span class="o">=</span> <span class="mi">3</span>

    <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - Returns plotly&#39;s figure object, takes care of spin-polarized calculations automatically. `elements`,`orbs` and `labels` are required to be one-to-one lists of size 3 where each item in list could be another list or integer.</span>
<span class="sd">    - **Parameters**</span>
<span class="sd">        - path_evr  : Path/to/vasprun.xml or xml output of `read_asxml`.</span>
<span class="sd">        - elements   : List of size 3 of list of indices of ions. If not given, picks all ions for each orbital.</span>
<span class="sd">        - orbs       : List of size 3 of list of orbital indices, if not gievn, s,p,d plotted.</span>
<span class="sd">        - labels  : List of labels for projection.</span>
<span class="sd">        - mode       : Three plotting modes are available:</span>
<span class="sd">            - &#39;markers&#39; : Plot whole data as a single scatter object. Its too fast.</span>
<span class="sd">            - &#39;bands&#39;   : Plot data such that each band is accessible via legend.</span>
<span class="sd">            - &#39;lines&#39;   : A replica of `matplotlib LineCollection` object. It plots at each point separately, slower than other two modes.</span>
<span class="sd">        - **kwargs      : interpolate, ticks, figsize,elim,joinPathAt,max_width,title etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span><span class="s1">&#39;bands&#39;</span><span class="p">,</span><span class="s1">&#39;lines&#39;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument `mode` expects one of [&#39;markers&#39;,&#39;bands&#39;,&#39;lines&#39;], got &#39;</span><span class="si">{}</span><span class="s2">&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
        <span class="k">return</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;orbs/elements have structure [[],[],[]], do not reduce structure even if it is empty.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="c1">#checking type of given path.</span>
    <span class="k">if</span><span class="p">(</span><span class="n">path_evr</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">vr</span><span class="o">=</span><span class="n">vp</span><span class="o">.</span><span class="n">export_vasprun</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path_evr</span><span class="p">,</span><span class="n">skipk</span><span class="o">=</span><span class="n">skipk</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="n">elim</span><span class="p">,</span><span class="n">joinPathAt</span><span class="o">=</span><span class="n">joinPathAt</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">path_evr</span><span class="o">!=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span> <span class="k">as</span> <span class="n">pt</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">path_evr</span><span class="p">)</span><span class="o">==</span><span class="n">vp</span><span class="o">.</span><span class="n">Dict2Data</span><span class="p">):</span>
            <span class="n">vr</span><span class="o">=</span><span class="n">path_evr</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path_evr</span><span class="p">)):</span>
            <span class="n">vr</span><span class="o">=</span><span class="n">vp</span><span class="o">.</span><span class="n">export_vasprun</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path_evr</span><span class="p">,</span><span class="n">skipk</span><span class="o">=</span><span class="n">skipk</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="n">elim</span><span class="p">,</span><span class="n">joinPathAt</span><span class="o">=</span><span class="n">joinPathAt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;path_evr = `</span><span class="si">{}</span><span class="s2">` does not exist&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path_evr</span><span class="p">))</span>
    <span class="c1"># Apply a robust final check.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">vr</span><span class="o">.</span><span class="n">bands</span><span class="p">;</span><span class="n">vr</span><span class="o">.</span><span class="n">kpath</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Object: </span><span class="se">\n</span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">is like a lower tree of export_vasprun(). Expects top tree.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vr</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">## Main working here.</span>
        <span class="k">if</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">pro_bands</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">gu</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="s2">&quot;Can not plot an empty eigenvalues object.&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="n">gu</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="s2">&quot;Try with large energy range.&quot;</span><span class="p">))</span>
        <span class="c1">#=====================================================</span>
        <span class="n">orbs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">item</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">==</span><span class="nb">int</span> <span class="k">else</span> <span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">orbs</span><span class="p">]</span> <span class="c1">#Fix if integer given.</span>
        <span class="n">elem_inds</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">sys_info</span><span class="o">.</span><span class="n">ElemIndex</span>
        <span class="n">max_ind</span>   <span class="o">=</span> <span class="n">elem_inds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="c1"># Last index is used for range in ElemIndex, not python index.</span>

        <span class="n">nfields</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">sys_info</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>

        <span class="c1"># Fix int elements and orbs</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">elements</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">==</span><span class="nb">int</span> <span class="ow">and</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="n">elem_inds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">elem_inds</span><span class="p">[</span><span class="n">e</span><span class="p">],</span><span class="n">elem_inds</span><span class="p">[</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">_elements_inds</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">es</span> <span class="ow">in</span> <span class="n">elements</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">es</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">_elements_inds</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">_elements_inds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_ind</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;index </span><span class="si">{}</span><span class="s2"> is out of bound for </span><span class="si">{}</span><span class="s2"> elements.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">_elements_inds</span><span class="p">),</span><span class="n">max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">_orb_inds</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbs</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">_orb_inds</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">_orb_inds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">nfields</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;index </span><span class="si">{}</span><span class="s2"> is out of bound for </span><span class="si">{}</span><span class="s2"> orbitals.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">_orb_inds</span><span class="p">),</span><span class="n">nfields</span><span class="p">))</span>

        <span class="k">if</span><span class="p">(</span><span class="n">E_Fermi</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">E_Fermi</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">bands</span><span class="o">.</span><span class="n">E_Fermi</span>
        <span class="n">K</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">kpath</span>
        <span class="n">xticks</span><span class="o">=</span><span class="p">[</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xt_indices</span><span class="p">]</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">K</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">K</span><span class="p">)]</span>
        <span class="k">if</span><span class="p">(</span><span class="n">elim</span><span class="p">):</span>
            <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">elim</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">elim</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
        <span class="c1"># If elements not given, get whole system</span>
        <span class="k">if</span> <span class="n">_elements_inds</span><span class="o">==</span><span class="p">[]:</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
        <span class="c1"># If orbs not given, get whole projections.</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_orb_inds</span><span class="o">==</span><span class="p">[]):</span>
            <span class="k">if</span><span class="p">(</span><span class="n">nfields</span><span class="o">==</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">orbs</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="k">if</span><span class="p">(</span><span class="n">nfields</span><span class="o">==</span><span class="mi">9</span> <span class="ow">or</span> <span class="n">nfields</span><span class="o">==</span><span class="mi">16</span><span class="p">):</span>
                <span class="n">orbs</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">_elements_inds</span><span class="o">==</span><span class="p">[]</span> <span class="ow">and</span> <span class="n">_orb_inds</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sys-s&#39;</span><span class="p">,</span><span class="s1">&#39;sys-p&#39;</span><span class="p">,</span><span class="s1">&#39;sys-d&#39;</span><span class="p">]</span>
        <span class="c1">#====Title Name======</span>
        <span class="n">SYSTEM</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">sys_info</span><span class="o">.</span><span class="n">SYSTEM</span>
        <span class="k">if</span><span class="p">(</span><span class="n">title</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">title</span><span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">[</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SYSTEM</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>

        <span class="c1"># After All Fixing</span>
        <span class="n">ISPIN</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">sys_info</span><span class="o">.</span><span class="n">ISPIN</span>
        <span class="n">args_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">orbs</span><span class="o">=</span><span class="n">orbs</span><span class="p">,</span><span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">,</span><span class="n">interpolate</span><span class="o">=</span><span class="n">interpolate</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span><span class="n">scale_color</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Do not scale color there, scale here.</span>
        <span class="n">data</span><span class="p">,</span><span class="n">showlegend</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="p">[],</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;&#39;</span> <span class="c1"># Place holder</span>
        <span class="k">if</span><span class="p">(</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;bands&#39;</span><span class="p">):</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ISPIN</span><span class="o">==</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">En</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">bands</span><span class="o">.</span><span class="n">evals</span><span class="o">-</span><span class="n">E_Fermi</span>
            <span class="n">Pros</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">pro_bands</span><span class="o">.</span><span class="n">pros</span>
            <span class="n">new_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">kpath</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">evals_set</span><span class="o">=</span><span class="n">En</span><span class="p">,</span> <span class="n">pros_set</span><span class="o">=</span><span class="n">Pros</span><span class="p">,</span><span class="o">**</span><span class="n">args_dict</span><span class="p">)</span>
            <span class="n">rgb_lines</span><span class="o">=</span><span class="n">get_rgb_data</span><span class="p">(</span><span class="o">**</span><span class="n">new_args</span><span class="p">)</span>
            <span class="n">data</span><span class="o">=</span><span class="n">rgb_to_plotly</span><span class="p">(</span><span class="n">rgb_data</span><span class="o">=</span><span class="n">rgb_lines</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">showlegend</span><span class="o">=</span><span class="n">showlegend</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="n">max_width</span><span class="o">=</span><span class="n">max_width</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ISPIN</span><span class="o">==</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">if</span><span class="p">(</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;markers&#39;</span><span class="p">):</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span>
            <span class="n">En1</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">bands</span><span class="o">.</span><span class="n">evals</span><span class="o">.</span><span class="n">SpinUp</span><span class="o">-</span><span class="n">E_Fermi</span>
            <span class="n">En2</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">bands</span><span class="o">.</span><span class="n">evals</span><span class="o">.</span><span class="n">SpinDown</span><span class="o">-</span><span class="n">E_Fermi</span>
            <span class="n">Pros1</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">pro_bands</span><span class="o">.</span><span class="n">pros</span><span class="o">.</span><span class="n">SpinUp</span>
            <span class="n">Pros2</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">pro_bands</span><span class="o">.</span><span class="n">pros</span><span class="o">.</span><span class="n">SpinDown</span>
            <span class="n">new_args1</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">kpath</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">evals_set</span><span class="o">=</span><span class="n">En1</span><span class="p">,</span> <span class="n">pros_set</span><span class="o">=</span><span class="n">Pros1</span><span class="p">,</span><span class="o">**</span><span class="n">args_dict</span><span class="p">)</span>
            <span class="n">rgb_lines1</span><span class="o">=</span><span class="n">get_rgb_data</span><span class="p">(</span><span class="o">**</span><span class="n">new_args1</span><span class="p">)</span>
            <span class="n">data1</span><span class="o">=</span><span class="n">rgb_to_plotly</span><span class="p">(</span><span class="n">rgb_data</span><span class="o">=</span><span class="n">rgb_lines1</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">symbol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">showlegend</span><span class="o">=</span><span class="n">showlegend</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;B&lt;sup&gt;↑&lt;/sup&gt;&#39;</span><span class="p">,</span><span class="n">max_width</span><span class="o">=</span><span class="n">max_width</span><span class="p">)</span>
            <span class="n">new_args2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">kpath</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">evals_set</span><span class="o">=</span><span class="n">En2</span><span class="p">,</span> <span class="n">pros_set</span><span class="o">=</span><span class="n">Pros2</span><span class="p">,</span><span class="o">**</span><span class="n">args_dict</span><span class="p">)</span>
            <span class="n">rgb_lines2</span><span class="o">=</span><span class="n">get_rgb_data</span><span class="p">(</span><span class="o">**</span><span class="n">new_args2</span><span class="p">)</span>
            <span class="n">data2</span><span class="o">=</span><span class="n">rgb_to_plotly</span><span class="p">(</span><span class="n">rgb_data</span><span class="o">=</span><span class="n">rgb_lines2</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">symbol</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">showlegend</span><span class="o">=</span><span class="n">showlegend</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;B&lt;sup&gt;↓&lt;/sup&gt;&#39;</span><span class="p">,</span><span class="n">max_width</span><span class="o">=</span><span class="n">max_width</span><span class="p">)</span>
            <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">]</span> <span class="k">for</span> <span class="n">d1</span><span class="p">,</span><span class="n">d2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span><span class="n">data2</span><span class="p">)]</span>
            <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">]</span>
        <span class="c1"># Initiate figure</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">margin</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">Margin</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="c1">#paper_bgcolor=&quot;whitesmoke&quot;,</span>
            <span class="n">yaxis</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">YAxis</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">,</span><span class="nb">range</span><span class="o">=</span><span class="n">ylim</span><span class="p">),</span>
            <span class="n">xaxis</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">XAxis</span><span class="p">(</span><span class="n">ticktext</span><span class="o">=</span><span class="n">xt_labels</span><span class="p">,</span> <span class="n">tickvals</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span>
            <span class="n">tickmode</span><span class="o">=</span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="nb">range</span><span class="o">=</span><span class="n">xlim</span><span class="p">),</span><span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;stix, serif&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">))</span>
        <span class="k">if</span><span class="p">(</span><span class="n">figsize</span><span class="o">!=</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">figsize</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">height</span><span class="o">=</span><span class="n">figsize</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">autosize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1">#Draw lines at breakpoints</span>
        <span class="k">if</span><span class="p">(</span><span class="n">joinPathAt</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">joinPathAt</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">K</span><span class="p">[</span><span class="n">pt</span><span class="p">],</span><span class="n">K</span><span class="p">[</span><span class="n">pt</span><span class="p">]],</span><span class="n">y</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(0,0,0)&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">K</span><span class="p">[</span><span class="n">pt</span><span class="p">],</span><span class="n">K</span><span class="p">[</span><span class="n">pt</span><span class="p">]],</span><span class="n">y</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(222,222,222)&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mf">1.2</span><span class="p">),</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zeroline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;rgba(222,222,222,0.1)&#39;</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;rgba(222,222,222,0.1)&#39;</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span></div>

<span class="c1"># Cell</span>
<div class="viewcode-block" id="plotly_dos_lines"><a class="viewcode-back" href="../../api.html#pivotpy.i_plots.plotly_dos_lines">[docs]</a><span class="k">def</span> <span class="nf">plotly_dos_lines</span><span class="p">(</span><span class="n">path_evr</span>     <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">elim</span>          <span class="o">=</span> <span class="p">[],</span>
                    <span class="n">elements</span>      <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,],],</span>
                    <span class="n">orbs</span>          <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">],],</span>
                    <span class="n">labels</span>        <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,],</span>
                    <span class="n">color_map</span>     <span class="o">=</span> <span class="s1">&#39;gist_rainbow&#39;</span><span class="p">,</span>
                    <span class="n">tdos_color</span>    <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                    <span class="n">linewidth</span>     <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="n">fill_area</span>     <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="n">vertical</span>      <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="n">E_Fermi</span>       <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">figsize</span>       <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">spin</span>          <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
                    <span class="n">interpolate</span>   <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="n">n</span>             <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
                    <span class="n">k</span>             <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                    <span class="n">title</span>         <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        - Returns ax object (if ax!=False) and plot on which all matplotlib allowed actions could be performed, returns lists of energy,tdos and pdos and labels. If given,elements,orbs colors, and labels must have same length. If not given, zeroth ions is plotted with s-orbital.</span>
<span class="sd">        - **Parameters**)</span>
<span class="sd">            - path_evr   : Path/to/vasprun.xml or output of `export_vasprun`. Auto picks in CWD.</span>
<span class="sd">            - elim       : [min,max] of energy range.</span>
<span class="sd">            - E_Fermi    : If not given, automatically picked from `export_vasprun`.</span>
<span class="sd">            - elements   : List [[0,],] of ions indices, by defualt plot first ion&#39;s projections.</span>
<span class="sd">            - orbs       : List [[0,],] lists of indices of orbitals, could be empty.</span>
<span class="sd">            - labels     : List [str,] of orbitals labels. len(labels)==len(orbs) must hold.</span>
<span class="sd">            - color_map  : Matplotlib&#39;s standard color maps. Default is &#39;gist_ranibow&#39;. Use &#39;RGB&#39; if want to compare with `plotly_rgb_lines` with 3 projection inputs (len(orbs)==3).</span>
<span class="sd">            - fill_area  : Default is True and plots filled area for dos. If False, plots lines only.</span>
<span class="sd">            - vertical   : False, If True, plots along y-axis.</span>
<span class="sd">            - figsize    : Tuple in pixels (width,height).</span>
<span class="sd">            - interpolate: Default is False, if True, bands are interpolated.</span>
<span class="sd">            - n          : int, number of points, default is 5.</span>
<span class="sd">            - k          : int, order of interpolation 0,1,2,3. Defualt 3. `n &gt; k` should be hold.</span>
<span class="sd">            - legend_kwargs: Dictionary to contain legend arguments to fix.</span>
<span class="sd">        - **Returns**</span>
<span class="sd">            - fig        : Plotly&#39;s figure object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">en</span><span class="p">,</span><span class="n">tdos</span><span class="p">,</span><span class="n">pdos</span><span class="p">,</span><span class="n">vr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span> <span class="c1"># Place holders for defining</span>
        <span class="n">cl_dos</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">collect_dos</span><span class="p">(</span><span class="n">path_evr</span><span class="o">=</span><span class="n">path_evr</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="n">elim</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">,</span> <span class="n">orbs</span><span class="o">=</span><span class="n">orbs</span><span class="p">,</span>\
                              <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">E_Fermi</span><span class="o">=</span><span class="n">E_Fermi</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">interpolate</span><span class="o">=</span><span class="n">interpolate</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">en</span><span class="p">,</span><span class="n">tdos</span><span class="p">,</span><span class="n">pdos</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">vr</span> <span class="o">=</span> <span class="n">cl_dos</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="n">gu</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="s2">&quot;Try with large energy range.&quot;</span><span class="p">))</span>

        <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;^↑&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;sup&gt;↑&lt;/sup&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;^↓&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;sup&gt;↓&lt;/sup&gt;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
        <span class="c1"># Make additional colors for spin down. Inverted colors are better.</span>
        <span class="k">if</span><span class="p">(</span><span class="n">elim</span><span class="p">):</span>
            <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">elim</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">elim</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
        <span class="c1"># Fix elements and colors length</span>
        <span class="k">if</span> <span class="n">color_map</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">():</span>
            <span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">cm</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tdos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">c_map</span>   <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">color_map</span><span class="p">)</span>
                <span class="n">c_vals</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">orbs</span><span class="p">))</span>
                <span class="n">colors</span>  <span class="o">=</span> <span class="n">c_map</span><span class="p">(</span><span class="n">c_vals</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c_map</span>   <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">color_map</span><span class="p">)</span>
                <span class="n">c_vals</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">orbs</span><span class="p">))</span>
                <span class="n">colors</span>  <span class="o">=</span> <span class="n">c_map</span><span class="p">(</span><span class="n">c_vals</span><span class="p">)</span>
            <span class="c1"># Fix for RGB comparison</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tdos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="s1">&#39;both&#39;</span> <span class="ow">in</span> <span class="n">spin</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">orbs</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">colors</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span><span class="o">=</span> <span class="n">colors</span><span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="c1">#Flip last two colors only</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;`color_map` expects one of the follwoing:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">()))</span>
        <span class="c1"># Total DOS colors</span>
        <span class="n">t_color</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="n">tdos_color</span><span class="p">)</span>
        <span class="n">it_color</span><span class="o">=</span><span class="n">gu</span><span class="o">.</span><span class="n">transform_color</span><span class="p">(</span><span class="n">t_color</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#inverts for c = -1</span>
        <span class="c1">#========Title Name========</span>
        <span class="n">SYSTEM</span><span class="o">=</span><span class="n">vr</span><span class="o">.</span><span class="n">sys_info</span><span class="o">.</span><span class="n">SYSTEM</span>
        <span class="k">if</span><span class="p">(</span><span class="n">title</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SYSTEM</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">Margin</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>\
                          <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;stix, serif&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">))</span>
        <span class="k">if</span><span class="p">(</span><span class="n">figsize</span><span class="o">!=</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">figsize</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">height</span><span class="o">=</span><span class="n">figsize</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">autosize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">vertical</span><span class="o">==</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">if</span><span class="p">(</span><span class="n">fill_area</span><span class="o">==</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">None</span>
            <span class="k">if</span><span class="p">(</span><span class="n">fill_area</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
                <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;tozeroy&#39;</span>
            <span class="n">args_dic</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">line_width</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tdos</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">):</span>   <span class="c1"># Spin polarized.</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">en</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">tdos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t_color</span><span class="p">]),</span>\
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TDOS&lt;sup&gt;↑&lt;/sup&gt;&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">args_dic</span><span class="p">)</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">en</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">tdos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it_color</span><span class="p">]),</span>\
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TDOS&lt;sup&gt;↓&lt;/sup&gt;&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">args_dic</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>   <span class="c1"># unpolarized.</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">en</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">tdos</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t_color</span><span class="p">]),</span>\
                              <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TDOS&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">args_dic</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pdos</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">colors</span><span class="p">):</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">en</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">p</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]),</span>\
                               <span class="n">name</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="o">**</span><span class="n">args_dic</span><span class="p">))</span>
        <span class="k">if</span><span class="p">(</span><span class="n">vertical</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">if</span><span class="p">(</span><span class="n">fill_area</span><span class="o">==</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">None</span>
            <span class="k">if</span><span class="p">(</span><span class="n">fill_area</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
                <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;tozerox&#39;</span>
            <span class="n">args_dic</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">line_width</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tdos</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">):</span>   <span class="c1"># Spin polarized.</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">en</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">tdos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t_color</span><span class="p">]),</span>\
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TDOS&lt;sup&gt;↑&lt;/sup&gt;&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">args_dic</span><span class="p">)</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">en</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">tdos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it_color</span><span class="p">]),</span>\
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TDOS&lt;sup&gt;↓&lt;/sup&gt;&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">args_dic</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>   <span class="c1"># unpolarized.</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">en</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">tdos</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t_color</span><span class="p">]),</span>\
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TDOS&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">args_dic</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pdos</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">colors</span><span class="p">):</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">en</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">p</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;rgb(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]),</span>\
                                <span class="n">name</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="o">**</span><span class="n">args_dic</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;rgba(222,222,222,0.1)&#39;</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;rgba(222,222,222,0.1)&#39;</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Abdul Saboor

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>