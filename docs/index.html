---

title: PivotPy


keywords: fastai
sidebar: home_sidebar

summary: "A Python Processing Tool for Vasp Input/Output. A CLI is available in Powershell, see <a href='https://github.com/massgh/Vasp2Visual'>Vasp2Visual</a>."
description: "A Python Processing Tool for Vasp Input/Output. A CLI is available in Powershell, see <a href='https://github.com/massgh/Vasp2Visual'>Vasp2Visual</a>."
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://testazurenotebooks-massaz.notebooks.azure.com/j/notebooks/test.ipynb"><img src="https://notebooks.azure.com/launch.png" alt="Run in Azure"></a>
<a href="https://colab.research.google.com/github/massgh/pivotpy/blob/master/test.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2><p><code>pip install pivotpy</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2><ul>
<li><a href="https://github.com/massgh/pivotpy/tree/master/functions.md">Read Function References</a></li>
<li>See <a href="https://massgh.github.io/pivotpy/">Full Documentation</a>.</li>
<li>For CLI, use <a href="https://github.com/massgh/Vasp2Visual">Vasp2Visual</a>.</li>
</ul>
<h2 id="Changelog-for-version-0.9.5-onward">Changelog for version 0.9.5 onward<a class="anchor-link" href="#Changelog-for-version-0.9.5-onward"> </a></h2><ul>
<li><code>pivotpy.s_plots.quick_rgb_lines</code> and <code>pivotpy.s_plots.quick_rgb_lines</code> are refactored and no more depnd on <code>create_rgb_lines</code>, so this function is dropped, If you still want to use it, use versions below 0.9.5. </li>
<li>A class <code>pivotpy.g_utils.Vasprun</code> is added which provides shortcut for <a href="/pivotpy/XmlElementTree.html#export_vasprun"><code>export_vasprun</code></a> and plotting functions. Under this class:<ul>
<li><a href="/pivotpy/StaticPlots.html#quick_bplot"><code>quick_bplot</code></a>       --&gt; <code>sbands</code></li>
<li><a href="/pivotpy/StaticPlots.html#quick_rgb_lines"><code>quick_rgb_lines</code></a>   --&gt; <code>srgb</code></li>
<li><a href="/pivotpy/InteractivePlots.html#plotly_rgb_lines"><code>plotly_rgb_lines</code></a>  --&gt; <code>irgb</code></li>
<li><a href="/pivotpy/StaticPlots.html#quick_color_lines"><code>quick_color_lines</code></a> --&gt; <code>scolor</code></li>
<li><a href="/pivotpy/StaticPlots.html#quick_dos_lines"><code>quick_dos_lines</code></a>   --&gt; <code>sdos</code></li>
<li><a href="/pivotpy/InteractivePlots.html#plotly_dos_lines"><code>plotly_dos_lines</code></a>  --&gt; <code>idos</code></li>
</ul>
</li>
<li>A class <code>pivotpy.g_utils.LOCPOT_CHG</code> is added which can be used to parse and visualize files like LOCPOT and CHG. </li>
<li>A function <code>pivotpy.vr_parser.split_vasprun</code> is added which splits <code>vasprun.xml</code> file into a small file <code>_vasprun.xml</code> without projected data and creates text files <code>_set[1,2,3,4].txt</code> based on how many spin sets are there. </li>
<li>A function <code>pivotpy.vr_parser.islice2array</code> is added which can reads data from text/csv/tsv files (even if text and numbers are mixed) accoridng to slices you provide, this does not load full file in memory and it is also useful in parsing EIGENVAL, PROCAR like files with a few lines of code only. </li>
<li>Version 1.0.0 is updated with an overhaul of widgets module. <a href="/pivotpy/Widgets.html#VasprunApp"><code>VasprunApp</code></a> is introduced as class to access internals of app easily. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="New:-Plot-in-Terminal-without-GUI">New: Plot in Terminal without GUI<a class="anchor-link" href="#New:-Plot-in-Terminal-without-GUI"> </a></h2><p>Use <code>pp.plt2text(colorful=True/False)</code> after matplotlib's code and your figure will appear in terminal. You need to zoom out alot to get a good view like below.</p>
<p>Tip: Use file <a href="https://gist.github.com/massgh/d5cc44ad32510d3ff58cfefd75c6884e">matplotlib2terminal.py</a> on github independent of this package to plot in terminal. 
<img src="/pivotpy/terminal.jpg" alt="IMG"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="New:-Ipywidgets-based-GUI">New: Ipywidgets-based GUI<a class="anchor-link" href="#New:-Ipywidgets-based-GUI"> </a></h1><p>See GIF here:
<img src="/pivotpy/widget.gif" alt="GIF"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>The code at end is used below to rebuild dataframe which can be use in many ways such as generating latex table. The matplotlib code is used to generate publication quality figure.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span>
<span class="kn">import</span> <span class="nn">pivotpy</span> <span class="k">as</span> <span class="nn">pp</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;e:/Research/graphene_example/ISPIN_1/bands/DOS/vasprun.xml&#39;</span><span class="p">,</span>
         <span class="s1">&#39;e:/Research/graphene_example/ISPIN_1/bands/vasprun.xml&#39;</span><span class="p">,</span>
         <span class="s1">&#39;e:/Research/graphene_example/ISPIN_1/dos/vasprun.xml&#39;</span><span class="p">,</span>
         <span class="s1">&#39;e:/Research/graphene_example/ISPIN_2/bands/vasprun.xml&#39;</span><span class="p">,</span>
         <span class="s1">&#39;e:/Research/graphene_example/ISPIN_2/dos/sigm0_01/vasprun.xml&#39;</span><span class="p">,</span>
         <span class="s1">&#39;e:/Research/graphene_example/ISPIN_2/dos/vasprun.xml&#39;</span><span class="p">,</span>
         <span class="s1">&#39;e:/Research/graphene_example/vasprun.xml&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">generate_summary</span><span class="p">(</span><span class="n">paths_list</span><span class="o">=</span><span class="n">paths</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">caption</span><span class="p">)</span>
<span class="n">Markdown</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">to_latex</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">init_figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mf">1.5</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;VBM&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;VBM&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CBM&#39;</span><span class="p">,</span><span class="s1">&#39;E_gap&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> 
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;E:/Research/graphene_example/ISPIN_1/bands&#39;</span><span class="p">)</span>
<span class="n">xml_data</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">read_asxml</span><span class="p">()</span>
<span class="n">vr</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">export_vasprun</span><span class="p">(</span><span class="n">elim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">vr</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Matplotlib's-static-plots">Matplotlib's static plots<a class="anchor-link" href="#Matplotlib's-static-plots"> </a></h2><p>Add anything from legend,colorbar, colorwheel. In below figure, all three are shown.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pivotpy</span> <span class="k">as</span> <span class="nn">pp</span><span class="o">,</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="n">vr1</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">export_vasprun</span><span class="p">(</span><span class="s1">&#39;E:/Research/graphene_example/ISPIN_2/bands/vasprun.xml&#39;</span><span class="p">)</span>
<span class="n">vr2</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">export_vasprun</span><span class="p">(</span><span class="s1">&#39;E:/Research/graphene_example/ISPIN_2/dos/vasprun.xml&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">init_figure</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">widths</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">2.2</span><span class="p">],</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mf">2.6</span><span class="p">))</span>
<span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">orbs</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;$p_z$&#39;</span><span class="p">,</span><span class="s1">&#39;$(p_x+p_y)$&#39;</span><span class="p">]</span>
<span class="n">ti_cks</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">ktick_inds</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">ktick_vals</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Γ&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">,</span><span class="s1">&#39;Γ&#39;</span><span class="p">])</span>
<span class="n">args_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">,</span><span class="n">orbs</span><span class="o">=</span><span class="n">orbs</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
<span class="n">pp</span><span class="o">.</span><span class="n">quick_bplot</span><span class="p">(</span><span class="n">path_evr</span><span class="o">=</span><span class="n">vr1</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">**</span><span class="n">ti_cks</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
<span class="n">pp</span><span class="o">.</span><span class="n">quick_rgb_lines</span><span class="p">(</span><span class="n">path_evr</span><span class="o">=</span><span class="n">vr1</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="o">**</span><span class="n">args_dict</span><span class="p">,</span><span class="o">**</span><span class="n">ti_cks</span><span class="p">,</span><span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">quick_dos_lines</span><span class="p">(</span><span class="n">path_evr</span><span class="o">=</span><span class="n">vr2</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">include_dos</span><span class="o">=</span><span class="s1">&#39;pdos&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">args_dict</span><span class="p">,</span><span class="n">legend_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ncol&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span><span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;RGB_m&#39;</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">color_wheel</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">1.15</span><span class="p">),</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">l</span><span class="o">+</span><span class="s1">&#39;$^{⇅}$&#39;</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
<span class="n">pp</span><span class="o">.</span><span class="n">_show</span><span class="p">()</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Interactive-plots-using-plotly">Interactive plots using plotly<a class="anchor-link" href="#Interactive-plots-using-plotly"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;p_z&#39;</span><span class="p">,</span><span class="s1">&#39;p_x+p_y&#39;</span><span class="p">]</span>
<span class="n">fig1</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">plotly_rgb_lines</span><span class="p">(</span><span class="n">vr1</span><span class="p">,</span><span class="o">**</span><span class="n">args_dict</span><span class="p">)</span>
<span class="c1">#pp.plotly2html(fig1) #Do inside Google Colab, fig1 inside Jupyter</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span>
<span class="n">Markdown</span><span class="p">(</span><span class="s2">&quot;[See Interactive Plot](https://massgh.github.io/InteractiveHTMLs/iGraphene.html)&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Brillouin-Zone-(BZ)-Processing">Brillouin Zone (BZ) Processing<a class="anchor-link" href="#Brillouin-Zone-(BZ)-Processing"> </a></h2><ul>
<li>Look in <code>pivotpy.sio</code> module for details on generating mesh and path of KPOINTS as well as using Materials Projects' API to get POSCAR right in the working folder with command <a href="/pivotpy/StructureIO.html#get_poscar"><code>get_poscar</code></a>. Below is a screenshot of interactive BZ plot. You can <code>double click</code> on blue points and hit <code>Ctrl + C</code> to copy the high symmetry points relative to reciprocal lattice basis vectors. (You will be able to draw kpath in <code>Pivotpy-Dash</code> application and generate KPOINTS automatically from a web interface later on!). </li>
<li>Same color points lie on a sphere, with radius decreasing as red to blue and  gamma point in gold color. These color help distinguishing points but the points not always be equivalent, for example in FCC, there are two points on mid of edges connecting square-hexagon and hexagon-hexagon at equal distance from center but not the same points. </li>
<li>Any colored point's hover text is in gold background.<br>
#### Look the output of <code>pivotpy.sio.splot_bz</code>.
<img src="/pivotpy/docs/images/3bz.jpg" alt="BZ"></li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pivotpy</span> <span class="k">as</span> <span class="nn">pp</span> 
<span class="n">pp</span><span class="o">.</span><span class="n">splot_bz</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">light_from</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;RGB&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="c1">#pp.plotly2html(fig2) #Do inside Google Colab, fig1 inside Jupyter</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span>
<span class="n">Markdown</span><span class="p">(</span><span class="s2">&quot;[See Interactive BZ Plot](https://massgh.github.io/InteractiveHTMLs/BZ.html)&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plotting-Two-Calculations-Side-by-Side">Plotting Two Calculations Side by Side<a class="anchor-link" href="#Plotting-Two-Calculations-Side-by-Side"> </a></h2><ul>
<li>Here we will use <code>shift_kpath</code> to demonstrate plot of two calculations on same axes side by side</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pivotpy</span> <span class="k">as</span> <span class="nn">pp</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;bmh&#39;</span><span class="p">)</span>
<span class="n">vr1</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">export_vasprun</span><span class="p">(</span><span class="s1">&#39;E:/Research/graphene_example/ISPIN_1/bands/vasprun.xml&#39;</span><span class="p">)</span>
<span class="n">shift_kpath</span><span class="o">=</span><span class="n">vr1</span><span class="o">.</span><span class="n">kpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Add last point from first export in second one.</span>
<span class="n">vr2</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">export_vasprun</span><span class="p">(</span><span class="s1">&#39;E:/Research/graphene_example/ISPIN_2/bands/vasprun.xml&#39;</span><span class="p">,</span><span class="n">shift_kpath</span><span class="o">=</span><span class="n">shift_kpath</span><span class="p">)</span>
<span class="n">last_k</span><span class="o">=</span><span class="n">vr2</span><span class="o">.</span><span class="n">kpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">axs</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">init_figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">2.6</span><span class="p">))</span>
<span class="n">K_all</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">vr1</span><span class="o">.</span><span class="n">kpath</span><span class="p">,</span><span class="o">*</span><span class="n">vr2</span><span class="o">.</span><span class="n">kpath</span><span class="p">]</span> <span class="c1"># Merge kpath for ticks</span>
<span class="n">kticks</span><span class="o">=</span><span class="p">[</span><span class="n">K_all</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">ti_cks</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="n">kticks</span><span class="p">,</span><span class="n">xt_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Γ&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">,</span><span class="s1">&#39;Γ&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">,</span><span class="s1">&#39;Γ&#39;</span><span class="p">])</span>
<span class="n">pp</span><span class="o">.</span><span class="n">quick_bplot</span><span class="p">(</span><span class="n">path_evr</span><span class="o">=</span><span class="n">vr1</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">quick_bplot</span><span class="p">(</span><span class="n">path_evr</span><span class="o">=</span><span class="n">vr2</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span><span class="n">txt</span><span class="o">=</span><span class="s1">&#39;Graphene(Left: ISPIN=1, Right: ISPIN=2)&#39;</span><span class="p">,</span><span class="n">ctxt</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">modify_axes</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">last_k</span><span class="p">],</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="o">**</span><span class="n">ti_cks</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Interpolation">Interpolation<a class="anchor-link" href="#Interpolation"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pivotpy</span> <span class="k">as</span> <span class="nn">pp</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="n">k</span><span class="o">=</span><span class="n">vr1</span><span class="o">.</span><span class="n">kpath</span>
<span class="n">ef</span><span class="o">=</span><span class="n">vr1</span><span class="o">.</span><span class="n">bands</span><span class="o">.</span><span class="n">E_Fermi</span>
<span class="n">evals</span><span class="o">=</span><span class="n">vr1</span><span class="o">.</span><span class="n">bands</span><span class="o">.</span><span class="n">evals</span><span class="o">-</span><span class="n">ef</span>
<span class="c1">#Let&#39;s interpolate our graph to see effect. It is useful for colored graphs.</span>
<span class="n">knew</span><span class="p">,</span><span class="n">enew</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">interpolate_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">k</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">evals</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plot</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">evals</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;real data&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">evals</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolated&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span><span class="n">txts</span><span class="o">=</span><span class="s1">&#39;Graphene&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="LOCPOT,CHG-Visualization">LOCPOT,CHG Visualization<a class="anchor-link" href="#LOCPOT,CHG-Visualization"> </a></h2><p>check out the class <code>pivotpy.LOCPOT_CHG</code> to visulize local potential/charge and magnetization in a given direction.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Running-powershell-commands-from-python.">Running powershell commands from python.<a class="anchor-link" href="#Running-powershell-commands-from-python."> </a></h2><p>Some tasks are very tideious in python while just a click way in powershell. See below, and try to list processes in python yourself to see the difference!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pp</span><span class="o">.</span><span class="n">ps2std</span><span class="p">(</span><span class="n">ps_command</span><span class="o">=</span><span class="s1">&#39;(Get-Process)[0..4]&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Advancaed:-Poweshell-Cell/Line-Magic-%%ps/%ps">Advancaed: Poweshell Cell/Line Magic <code>%%ps/%ps</code><a class="anchor-link" href="#Advancaed:-Poweshell-Cell/Line-Magic-%%ps/%ps"> </a></h2><ul>
<li>You can create a IPython cell magic to run powershell commands directly in IPython Shell/Notebook (Powershell core installation required).</li>
<li>Cell magic can be assigned to a variable <code>foo</code> by <code>%%ps --out foo</code></li>
<li>Line magic can be assigned to a variable by <code>foo = %ps powershell_command</code></li>
</ul>
<p>Put below code in ipython profile's startup file (create one) "~/.ipython/profile_default/startup/powershell_magic.py"</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.magic</span> <span class="kn">import</span> <span class="n">register_line_cell_magic</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">get_ipython</span>
<span class="nd">@register_line_cell_magic</span>
<span class="k">def</span> <span class="nf">ps</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cell</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_cell_magic</span><span class="p">(</span><span class="s1">&#39;powershell&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">,</span><span class="n">cell</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_cell_magic</span><span class="p">(</span><span class="s1">&#39;powershell&#39;</span><span class="p">,</span><span class="s1">&#39;--out posh_output&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">posh_output</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</pre></div>
<p>Additionally you need to add following lines in "~/.ipython/profile_default/ipython_config.py" file to make above magic work.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">traitlets.config.application</span> <span class="kn">import</span> <span class="n">get_config</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">ScriptMagics</span><span class="o">.</span><span class="n">script_magics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;powershell&#39;</span><span class="p">]</span>
<span class="n">c</span><span class="o">.</span><span class="n">ScriptMagics</span><span class="o">.</span><span class="n">script_paths</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;powershell&#39;</span> <span class="p">:</span> <span class="s1">&#39;powershell.exe -noprofile -command -&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pwsh&#39;</span><span class="p">:</span> <span class="s1">&#39;pwsh.exe -noprofile -command -&#39;</span>
<span class="p">}</span>
</pre></div>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">ps</span> 
Get-ChildItem &#39;E:\Research\graphene_example\&#39;
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="o">%</span><span class="k">ps</span> (Get-ChildItem &#39;E:\Research\graphene_example\&#39;).FullName
<span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="functions.md">Functions Reference</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

