---

title: Xml Parser


keywords: fastai
sidebar: home_sidebar

summary: "This parser contains functions to extract data from vasprun.xml. All functions in xml parser can work without arguments if working directory contains `vasprun.xml`."
description: "This parser contains functions to extract data from vasprun.xml. All functions in xml parser can work without arguments if working directory contains `vasprun.xml`."
nb_path: "XmlElementTree.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: XmlElementTree.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Dic2Dot" class="doc_header"><code>class</code> <code>Dic2Dot</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L8" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Dic2Dot</code>() :: <code>dict</code></p>
</blockquote>
<ul>
<li>Returns dot notation accessible if a dictionary is input.</li>
<li>It is used to pack all functions in a dictionary.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Parser-Functions">Parser Functions<a class="anchor-link" href="#Parser-Functions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_asxml" class="doc_header"><code>read_asxml</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L19" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_asxml</code>(<strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>suppress_warning</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<ul>
<li><p>Reads a big vasprun.xml file into memory once and then apply commands.
If current folder contains <code>vasprun.xml</code> file, it automatically picks it.</p>
</li>
<li><p><strong>Parameters</strong></p>
<ul>
<li>path             : Path/To/vasprun.xml</li>
<li>suppress_warning : False by defualt. Warns about memory usage for large files &gt; 100 MB.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>xml_data : Xml object to use in other functions</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="exclude_kpts" class="doc_header"><code>exclude_kpts</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L69" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>exclude_kpts</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns number of kpoints to exclude used from IBZKPT.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>int      : Number of kpoints to exclude.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_ispin" class="doc_header"><code>get_ispin</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_ispin</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns value of ISPIN.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>int      : Value of ISPIN.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_summary" class="doc_header"><code>get_summary</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L107" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_summary</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns overview of system parameters.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>dict     : Dictionary that contains system information.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pivotpy.vr_parser</span> <span class="k">as</span> <span class="nn">vp</span>
<span class="n">xml_data</span><span class="o">=</span><span class="n">vp</span><span class="o">.</span><span class="n">read_asxml</span><span class="p">(</span><span class="n">path</span><span class="o">=</span> <span class="s1">&#39;../vasprun.xml&#39;</span><span class="p">)</span>
<span class="n">vp</span><span class="o">.</span><span class="n">get_summary</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-green-intense-fg"> 
      successful!
</span>
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;SYSTEM&#39;: &#39;AlAs&#39;,
 &#39;NION&#39;: 2,
 &#39;TypeION&#39;: 2,
 &#39;ElemName&#39;: [&#39;Al&#39;, &#39;As&#39;],
 &#39;ElemIndex&#39;: [0, 1, 2],
 &#39;ISPIN&#39;: 1,
 &#39;fields&#39;: [&#39;s&#39;, &#39;py&#39;, &#39;pz&#39;, &#39;px&#39;, &#39;dxy&#39;, &#39;dyz&#39;, &#39;dz2&#39;, &#39;dxz&#39;, &#39;x2-y2&#39;],
 &#39;incar&#39;: {&#39;SYSTEM&#39;: &#39;AlAs&#39;,
  &#39;PREC&#39;: &#39;high&#39;,
  &#39;ALGO&#39;: &#39;N&#39;,
  &#39;NELMIN&#39;: &#39;7&#39;,
  &#39;EDIFF&#39;: &#39;0.00000100&#39;,
  &#39;ISMEAR&#39;: &#39;0&#39;,
  &#39;SIGMA&#39;: &#39;0.10000000&#39;,
  &#39;LORBIT&#39;: &#39;11&#39;,
  &#39;KPOINT_BSE&#39;: &#39;-1     0     0     0&#39;,
  &#39;LHFCALC&#39;: &#39;T&#39;,
  &#39;HFSCREEN&#39;: &#39;0.20100000&#39;,
  &#39;PRECFOCK&#39;: &#39;fast&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_kpts" class="doc_header"><code>get_kpts</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L145" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_kpts</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>, <strong><code>skipk</code></strong>=<em><code>0</code></em>, <strong><code>joinPathAt</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<ul>
<li>Returns kpoints and calculated kpath.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data   : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
<li>skipk      : Number of initil kpoints to skip</li>
<li>joinPathAt : List of indices of kpoints where path is broken</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>dict     : Dictionary that contains kpoints ans kpath.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vp</span><span class="o">.</span><span class="n">get_kpts</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">,</span><span class="n">skipk</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;NKPTS&#39;, &#39;kpoints&#39;, &#39;kpath&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_tdos" class="doc_header"><code>get_tdos</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L179" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_tdos</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>, <strong><code>spin_set</code></strong>=<em><code>1</code></em>, <strong><code>elim</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<ul>
<li>Returns total dos for a spin_set (default 1) and energy limit. If spin-polarized calculations, gives SpinUp and SpinDown keys as well.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
<li>spin_set : int, default is 1.and</li>
<li>elim     : List [min,max] of energy, default empty.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>dict     : Dictionary that contains E_Fermi, ISPIN,tdos.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vp</span><span class="o">.</span><span class="n">get_tdos</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">,</span><span class="n">spin_set</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="p">[])</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;E_Fermi&#39;, &#39;ISPIN&#39;, &#39;tdos&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_evals" class="doc_header"><code>get_evals</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L232" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_evals</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>, <strong><code>skipk</code></strong>=<em><code>None</code></em>, <strong><code>elim</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<ul>
<li>Returns eigenvalues as numpy array. If spin-polarized calculations, gives SpinUp and SpinDown keys as well.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
<li>skipk    : Number of initil kpoints to skip.</li>
<li>elim     : List [min,max] of energy, default empty.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>dict     : Dictionary that contains evals and related parameters.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vp</span><span class="o">.</span><span class="n">get_evals</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">,</span><span class="n">skipk</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">vp</span><span class="o">.</span><span class="n">get_evals</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">,</span><span class="n">skipk</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">bands_range</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dict_keys([&#39;E_Fermi&#39;, &#39;ISPIN&#39;, &#39;NBANDS&#39;, &#39;bands_range&#39;, &#39;evals&#39;])
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>range(1, 8)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_bands_pro_set" class="doc_header"><code>get_bands_pro_set</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L285" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_bands_pro_set</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>, <strong><code>spin_set</code></strong>=<em><code>1</code></em>, <strong><code>skipk</code></strong>=<em><code>0</code></em>, <strong><code>bands_range</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns bands projection of a spin_set(default 1) as numpy array. If spin-polarized calculations, gives SpinUp and SpinDown keys as well.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data    : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
<li>skipk       : Number of initil kpoints to skip (Default 0).</li>
<li>spin_set    : Spin set to get, default is 1.</li>
<li>bands_range : If elim used in <a href="/pivotpy/XmlElementTree.html#get_evals"><code>get_evals</code></a>,that will return bands_range to use here..</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>dict     : Dictionary that contains bands projections and related parameters.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vp</span><span class="o">.</span><span class="n">get_bands_pro_set</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">,</span><span class="n">skipk</span><span class="o">=</span><span class="mi">135</span><span class="p">,</span><span class="n">spin_set</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">bands_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;labels&#39;: [&#39;s&#39;, &#39;py&#39;, &#39;pz&#39;, &#39;px&#39;, &#39;dxy&#39;, &#39;dyz&#39;, &#39;dz2&#39;, &#39;dxz&#39;, &#39;x2-y2&#39;],
 &#39;pros&#39;: array([[[[0.09  , 0.    , 0.    , 0.    , 0.    , 0.    , 0.    ,
           0.    , 0.    ]]],
 
 
        [[[0.4527, 0.    , 0.    , 0.    , 0.    , 0.    , 0.    ,
           0.    , 0.    ]]]])}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_dos_pro_set" class="doc_header"><code>get_dos_pro_set</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L338" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_dos_pro_set</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>, <strong><code>spin_set</code></strong>=<em><code>1</code></em>, <strong><code>dos_range</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns dos projection of a spin_set(default 1) as numpy array. If spin-polarized calculations, gives SpinUp and SpinDown keys as well.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data    : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
<li>spin_set    : Spin set to get, default 1.</li>
<li>dos_range   : If elim used in <a href="/pivotpy/XmlElementTree.html#get_tdos"><code>get_tdos</code></a>,that will return dos_range to use here..</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>dict        : Dictionary that contains dos projections and related parameters.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_structure" class="doc_header"><code>get_structure</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L381" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_structure</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns structure's volume,basis,positions and rec-basis.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>dict     : Dictionary that contains volume,basis,positions and rec_basis.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vp</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;volume&#39;, &#39;basis&#39;, &#39;rec_basis&#39;, &#39;positions&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Quick-Export-for-Bandstructure">Quick Export for Bandstructure<a class="anchor-link" href="#Quick-Export-for-Bandstructure"> </a></h2><p>A fully comprehensive command that uses all functions and returns data for spin set 1 (set 1 and 2 if spin-polarized calculations) could be constructed for immediate usage. It is <code>export_vasrun()</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="export_vasprun" class="doc_header"><code>export_vasprun</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L409" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>export_vasprun</code>(<strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>skipk</code></strong>=<em><code>None</code></em>, <strong><code>elim</code></strong>=<em><code>[]</code></em>, <strong><code>joinPathAt</code></strong>=<em><code>[]</code></em>, <strong><code>shift_kpath</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<ul>
<li>Returns a full dictionary of all objects from <code>vasprun.xml</code> file.</li>
<li><strong>Parameters</strong><ul>
<li>path       : Path to <code>vasprun.xml</code> file. Default is <code>'./vasprun.xml'</code>.</li>
<li>skipk      : Default is None. Automatically detects kpoints to skip.</li>
<li>elim       : List [min,max] of energy interval. Default is [], covers all bands.</li>
<li>joinPathAt : List of indices of kpoints where path is broken.</li>
<li>shift_kpath: Default 0. Can be used to merge multiple calculations on single axes side by side.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>dict : Dictionary accessible via dot notation containing objects:<ul>
<li>sys_info  : System Information</li>
<li>dim_info  : Contains information about dimensions of returned objects.</li>
<li>kpoints   : numpy array of kpoints with excluded IBZKPT points</li>
<li>kpath     : 1D numpy array directly accessible for plot.</li>
<li>bands     : Dictionary containing bands.</li>
<li>tdos      : Dictionary containing total dos.</li>
<li>pro_bands : Dictionary containing bands projections.</li>
<li>pro_dos   : Dictionary containing dos projections.</li>
<li>poscar    : containing basis,positions, rec_basis and volume.</li>
<li>xml       : xml root object which is iterable over nodes using xml.iter('node').</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pivotpy</span> <span class="k">as</span> <span class="nn">pp</span>
<span class="n">pp</span><span class="o">.</span><span class="n">export_vasprun</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;../vasprun.xml&#39;</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;sys_info&#39;, &#39;dim_info&#39;, &#39;kpoints&#39;, &#39;kpath&#39;, &#39;bands&#39;, &#39;tdos&#39;, &#39;pro_bands&#39;, &#39;pro_dos&#39;, &#39;poscar&#39;, &#39;xml&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Joining-Multiple-Calculations">Joining Multiple Calculations<a class="anchor-link" href="#Joining-Multiple-Calculations"> </a></h2><ul>
<li>Sometimes one may need to compare two or more bandstructures in same figure, for that reason, it is easy to export two calculations and plot on same axis.</li>
<li>There is another situation, if you have a large supercell and split calculations into multiple ones, joining that calculations works same way, you will add the last value of first kpath into all values of next kpath and next last to next and so on, by just using <code>shift_kpath</code> in <a href="/pivotpy/XmlElementTree.html#export_vasprun"><code>export_vasprun</code></a> and plot each export on same axis, this will align bandstructures side by side on same axis.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-Exported-Vasprun-from-PowerShell">Load Exported Vasprun from PowerShell<a class="anchor-link" href="#Load-Exported-Vasprun-from-PowerShell"> </a></h2><p>On Windows, it will work automatically. On Linux/Mac it may require path to powershell executable.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_export" class="doc_header"><code>load_export</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L482" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_export</code>(<strong><code>path</code></strong>=<em><code>'./vasprun.xml'</code></em>, <strong><code>joinPathAt</code></strong>=<em><code>[]</code></em>, <strong><code>shift_kpath</code></strong>=<em><code>0</code></em>, <strong><code>path_to_ps</code></strong>=<em><code>'pwsh'</code></em>, <strong><code>skipk</code></strong>=<em><code>None</code></em>, <strong><code>max_filled</code></strong>=<em><code>10</code></em>, <strong><code>max_empty</code></strong>=<em><code>10</code></em>, <strong><code>keep_files</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<ul>
<li>Returns a full dictionary of all objects from <code>vasprun.xml</code> file exported using powershell.</li>
<li><strong>Parameters</strong><ul>
<li>path       : Path to <code>vasprun.xml</code> file. Default is <code>'./vasprun.xml'</code>.</li>
<li>skipk      : Default is None. Automatically detects kpoints to skip.</li>
<li>path_to_ps : Path to <code>powershell.exe</code>. Automatically picks on Windows and Linux if added to PATH.</li>
<li>joinPathAt : List of indices of kpoints where path is broken.</li>
<li>shift_kpath: Default 0. Can be used to merge multiple calculations side by side.</li>
<li>keep_files : Could be use to clean exported text files. Default is True.</li>
<li>max_filled : Number of filled bands below and including VBM. Default is 10.</li>
<li>max_empty  : Number of empty bands above VBM. Default is 10.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>dict : Dictionary accessible via dot notation containing objects:<ul>
<li>sys_info  : System Information</li>
<li>dim_info  : Contains information about dimensions of returned objects.</li>
<li>kpoints   : numpy array of kpoints with excluded IBZKPT points</li>
<li>kpath     : 1D numpy array directly accessible for plot.</li>
<li>bands     : Dictionary containing bands.</li>
<li>tdos      : Dictionary containing total dos.</li>
<li>pro_bands : Dictionary containing bands projections.</li>
<li>pro_dos   : Dictionary containing dos projections.</li>
<li>poscar    : containing basis,positions, rec_basis and volume.</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_dot_dict" class="doc_header"><code>make_dot_dict</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L631" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_dot_dict</code>(<strong><code>json_loaded</code></strong>)</p>
</blockquote>
<ul>
<li>Returns a pivotpy.Dic2Dot object recursively and makes keys accessible via dot notation. Works only upto 4 nesting levels because it is basically created for vasprun data transfer back and forth in <code>pivotpy-dash</code> app.</li>
<li><strong>Parameters</strong><ul>
<li>json_load : Output of json.load/json.loads or any python dictionary.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pivotpy</span> <span class="k">as</span> <span class="nn">pp</span>
<span class="n">vr</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">export_vasprun</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;E:/Research/graphene_example/ISPIN_2/bands/vasprun.xml&quot;</span> <span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">vr</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xml&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span> <span class="c1">#Can&#39;t be serilized to json. </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ORIGINAL TYPE : </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">poscar</span><span class="p">)))</span>
<span class="n">s</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">vr</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">EncodeFromNumpy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;JSON DUMPED TYPE : </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">DecodeToNumpy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;JSON LOADED TYPE : </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">s2</span><span class="p">)))</span>
<span class="n">s3</span><span class="o">=</span> <span class="n">make_dot_dict</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;BACK TO ORIGINAL TYPE : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">s3</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ORIGINAL TYPE : &lt;class &#39;pivotpy.vr_parser.Dic2Dot&#39;&gt;

JSON DUMPED TYPE : &lt;class &#39;str&#39;&gt;

JSON LOADED TYPE : &lt;class &#39;dict&#39;&gt;

BACK TO ORIGINAL TYPE : &lt;class &#39;pivotpy.vr_parser.Dic2Dot&#39;&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to make sure that data transfer between different formats does not result in loss of any information, we can check few things in start and end.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">sys_info</span> <span class="o">==</span> <span class="n">s3</span><span class="o">.</span><span class="n">sys_info</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">dim_info</span> <span class="o">==</span> <span class="n">s3</span><span class="o">.</span><span class="n">dim_info</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">kpath</span> <span class="o">==</span> <span class="n">s3</span><span class="o">.</span><span class="n">kpath</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">bands</span><span class="o">.</span><span class="n">evals</span><span class="o">.</span><span class="n">SpinUp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">s3</span><span class="o">.</span><span class="n">bands</span><span class="o">.</span><span class="n">evals</span><span class="o">.</span><span class="n">SpinUp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">tdos</span><span class="o">.</span><span class="n">tdos</span><span class="o">.</span><span class="n">SpinUp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">s3</span><span class="o">.</span><span class="n">tdos</span><span class="o">.</span><span class="n">tdos</span><span class="o">.</span><span class="n">SpinUp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">pro_dos</span><span class="o">.</span><span class="n">pros</span><span class="o">.</span><span class="n">SpinUp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">s3</span><span class="o">.</span><span class="n">pro_dos</span><span class="o">.</span><span class="n">pros</span><span class="o">.</span><span class="n">SpinUp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">pro_bands</span><span class="o">.</span><span class="n">pros</span><span class="o">.</span><span class="n">SpinUp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">s3</span><span class="o">.</span><span class="n">pro_bands</span><span class="o">.</span><span class="n">pros</span><span class="o">.</span><span class="n">SpinUp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">poscar</span><span class="o">.</span><span class="n">basis</span> <span class="o">==</span> <span class="n">s3</span><span class="o">.</span><span class="n">poscar</span><span class="o">.</span><span class="n">basis</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>True
True
True
[ True  True  True  True]
[ True  True  True]
[ True  True  True  True  True  True  True  True  True  True]
[ True  True  True  True  True  True  True  True  True]
[[ True  True  True]
 [ True  True  True]
 [ True  True  True]]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This back and forth data transport is required in <a href="https://github.com/massgh/pivotpy-dash">pivotpy-dash</a> app where data is stored in browser in json format, but needs to by python objects for figures.</p>
<h2 id="Write-Clean-data-to-JSON-or-Pickle-file">Write Clean data to JSON or Pickle file<a class="anchor-link" href="#Write-Clean-data-to-JSON-or-Pickle-file"> </a></h2><p>Use <code>dump_vasprun</code> to write output of <a href="/pivotpy/XmlElementTree.html#export_vasprun"><code>export_vasprun</code></a> or <a href="/pivotpy/XmlElementTree.html#load_export"><code>load_export</code></a> to pickle/json file. Pickle is useful for quick load in python while json is useful to transfer data into any language.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dump_dict" class="doc_header"><code>dump_dict</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L657" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dump_dict</code>(<strong><code>dict_obj</code></strong>=<em><code>None</code></em>, <strong><code>dump_to</code></strong>=<em><code>'pickle'</code></em>, <strong><code>outfile</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Dump an <a href="/pivotpy/XmlElementTree.html#export_vasprun"><code>export_vasprun</code></a> or <a href="/pivotpy/XmlElementTree.html#load_export"><code>load_export</code></a> object to json or pickle string/file.</li>
<li><strong>Parameters</strong><ul>
<li>dict_obj : Any dictionary containg numpy arrays, including <a href="/pivotpy/XmlElementTree.html#export_vasprun"><code>export_vasprun</code></a> or <a href="/pivotpy/XmlElementTree.html#load_export"><code>load_export</code></a> output.</li>
<li>dump_to  : Defualt is <code>pickle</code> or <code>json</code>.</li>
<li>outfile  : Defualt is None and return string. File name does not require extension.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dump_dict</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Saboor&quot;</span><span class="p">}))</span>
<span class="n">dump_dict</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Saboor&quot;</span><span class="p">},</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>b&#39;\x80\x03}q\x00X\x04\x00\x00\x00nameq\x01X\x06\x00\x00\x00Saboorq\x02s.&#39;
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;{&#34;name&#34;: &#34;Saboor&#34;}&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

