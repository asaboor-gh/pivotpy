---

title: Xml Parser


keywords: fastai
sidebar: home_sidebar

summary: "This parser contains functions to extract data from vasprun.xml. All functions in xml parser can work without arguments if working directory contains `vasprun.xml`."
description: "This parser contains functions to extract data from vasprun.xml. All functions in xml parser can work without arguments if working directory contains `vasprun.xml`."
nb_path: "XmlElementTree.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: XmlElementTree.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">
<p><style>a{text-decoration: none !important;color:lightkblue;font-weight:bold;}
                a:focus,a:active,a:hover{color:hotpink !important;}</style></p>
<blockquote><p><a href="https://massgh.github.io/pivotpy/">&nbsp;<code>▶</code> Index&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/XmlElementTree">&nbsp;<code>▶</code> XmlElementTree●&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/StaticPlots">&nbsp;<code>▶</code> StaticPlots&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/InteractivePlots">&nbsp;<code>▶</code> InteractivePlots&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/Utilities">&nbsp;<code>▶</code> Utilities&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/StructureIO">&nbsp;<code>▶</code> StructureIO&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/Widgets">&nbsp;<code>▶</code> Widgets&nbsp;</a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Almost every object in this module returns a <a href="/pivotpy/XmlElementTree.html#Dict2Data"><code>Dict2Data</code></a> object with attributes accessible via dot notation. This object can by transformed to a dictionary by <code>to_dict()</code> method on the object.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dict2tuple" class="doc_header"><code>dict2tuple</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dict2tuple</code>(<strong><code>name</code></strong>, <strong><code>d</code></strong>)</p>
</blockquote>
<p>Converts a dictionary (nested as well) to namedtuple, accessible via index and dot notation as well as by unpacking.</p>
<ul>
<li><strong>Parameters</strong><ul>
<li>name: Name of the tuple.</li>
<li>d   : Dictionary, nested works as well.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Dict2Data" class="doc_header"><code>class</code> <code>Dict2Data</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L40" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Dict2Data</code>(<strong><code>d</code></strong>)</p>
</blockquote>
<ul>
<li>Returns a Data object with dictionary keys as attributes of Data accessible by dot notation or by key. Once an attribute is created, it can not be changed from outside.</li>
<li><strong>Parmeters</strong><ul>
<li>dict : Python dictionary (nested as well) containing any python data types.</li>
</ul>
</li>
<li><strong>Methods</strong><ul>
<li>to_dict  : Converts a Data object to dictionary if it could be made a dictionary, otherwise throws relevant error.</li>
<li>to_json  : Converts to json str or save to file if <code>outfil</code> given. Accepts <code>indent</code> as parameter.</li>
<li>to_pickle: Converts to bytes str or save to file if <code>outfile</code> given.</li>
<li>to_tuple : Converts to a named tuple.</li>
</ul>
</li>
<li><strong>Example</strong><blockquote><p>x = Dict2Data({'A':1,'B':{'C':2}})
x
Data(
    A = 1
    B = Data(
        C = 2
        )
    )
x.B.to_dict()
{'C': 2}</p>
</blockquote>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Dict2Data.to_dict" class="doc_header"><code>Dict2Data.to_dict</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L73" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Dict2Data.to_dict</code>()</p>
</blockquote>
<p>Converts a <a href="/pivotpy/XmlElementTree.html#Dict2Data"><code>Dict2Data</code></a> object (root or nested level) to a dictionary.</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Dict2Data.to_json" class="doc_header"><code>Dict2Data.to_json</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L83" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Dict2Data.to_json</code>(<strong><code>outfile</code></strong>=<em><code>None</code></em>, <strong><code>indent</code></strong>=<em><code>1</code></em>)</p>
</blockquote>
<p>Dumps a <a href="/pivotpy/XmlElementTree.html#Dict2Data"><code>Dict2Data</code></a> object (root or nested level) to json.</p>
<ul>
<li><strong>Parameters</strong><ul>
<li>outfile : Default is None and returns string. If given, writes to file.</li>
<li>indent  : Json indent. Default is 1.</li>
</ul>
</li>
</ul>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Dict2Data.to_pickle" class="doc_header"><code>Dict2Data.to_pickle</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L91" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Dict2Data.to_pickle</code>(<strong><code>outfile</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Dumps a <a href="/pivotpy/XmlElementTree.html#Dict2Data"><code>Dict2Data</code></a> object (root or nested level) to pickle.</p>
<ul>
<li><strong>Parameters</strong><ul>
<li>outfile : Default is None and returns string. If given, writes to file.</li>
</ul>
</li>
</ul>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Dict2Data.to_tuple" class="doc_header"><code>Dict2Data.to_tuple</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L98" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Dict2Data.to_tuple</code>()</p>
</blockquote>
<p>Creates a namedtuple.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Dict2Data</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dict: &#39;</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;JSON: &#39;</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pickle: &#39;</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tuple: &#39;</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">to_tuple</span><span class="p">())</span>
<span class="n">x</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Dict:  {&#39;A&#39;: 1, &#39;B&#39;: 2}
JSON:  {
 &#34;A&#34;: 1,
 &#34;B&#34;: 2
}
Pickle:  b&#39;\x80\x03}q\x00(X\x01\x00\x00\x00Aq\x01K\x01X\x01\x00\x00\x00Bq\x02K\x02u.&#39;
Tuple:  Data(A=1, B=2)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Parser-Functions">Parser Functions<a class="anchor-link" href="#Parser-Functions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_asxml" class="doc_header"><code>read_asxml</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L134" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_asxml</code>(<strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li><p>Reads a big vasprun.xml file into memory once and then apply commands. If current folder contains <code>vasprun.xml</code> file, it automatically picks it.</p>
</li>
<li><p><strong>Parameters</strong></p>
<ul>
<li>path : Path/To/vasprun.xml</li>
</ul>
</li>
<li><p><strong>Returns</strong></p>
<ul>
<li>xml_data : Xml object to use in other functions</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="xml2dict" class="doc_header"><code>xml2dict</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L171" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>xml2dict</code>(<strong><code>xmlnode_or_filepath</code></strong>)</p>
</blockquote>
<p>Convert xml node or xml file content to dictionary. All output text is in string format, so further processing is required to convert into data types/split etc.</p>
<ul>
<li>The only paramenter <code>xmlnode_or_filepath</code> is either a path to an xml file or an <code>xml.etree.ElementTree.Element</code> object.</li>
<li>Each node has <code>tag,text,attr,nodes</code> attributes. Every text element can be accessed via
<code>xml2dict()['nodes'][index]['nodes'][index]...</code> tree which makes it simple.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="exclude_kpts" class="doc_header"><code>exclude_kpts</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L187" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>exclude_kpts</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns number of kpoints to exclude used from IBZKPT.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>int      : Number of kpoints to exclude.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_ispin" class="doc_header"><code>get_ispin</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L208" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_ispin</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns value of ISPIN.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>int      : Value of ISPIN.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_summary" class="doc_header"><code>get_summary</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L225" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_summary</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns overview of system parameters.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>Data     : pivotpy.Dict2Data with attibutes accessible via dot notation.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pivotpy.vr_parser</span> <span class="k">as</span> <span class="nn">vp</span>
<span class="n">xml_data</span><span class="o">=</span><span class="n">vp</span><span class="o">.</span><span class="n">read_asxml</span><span class="p">(</span><span class="n">path</span><span class="o">=</span> <span class="s1">&#39;../vasprun.xml&#39;</span><span class="p">)</span>
<span class="n">get_summary</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">)</span><span class="o">.</span><span class="n">to_tuple</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Data(SYSTEM=&#39;AlAs&#39;, NION=2, NELECT=8, TypeION=2, ElemName=[&#39;Al&#39;, &#39;As&#39;], ElemIndex=[0, 1, 2], E_Fermi=3.72526782, ISPIN=1, fields=[&#39;s&#39;, &#39;py&#39;, &#39;pz&#39;, &#39;px&#39;, &#39;dxy&#39;, &#39;dyz&#39;, &#39;dz2&#39;, &#39;dxz&#39;, &#39;x2-y2&#39;], incar=INCAR(SYSTEM=&#39;AlAs&#39;, PREC=&#39;high&#39;, ALGO=&#39;N&#39;, NELMIN=&#39;7&#39;, EDIFF=&#39;0.00000100&#39;, ISMEAR=&#39;0&#39;, SIGMA=&#39;0.10000000&#39;, LORBIT=&#39;11&#39;, KPOINT_BSE=&#39;-1     0     0     0&#39;, LHFCALC=&#39;T&#39;, HFSCREEN=&#39;0.20100000&#39;, PRECFOCK=&#39;fast&#39;))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="join_ksegments" class="doc_header"><code>join_ksegments</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L265" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>join_ksegments</code>(<strong><code>kpath</code></strong>, <strong><code>kseg_inds</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<p>Joins a broken kpath's next segment to previous. <code>kseg_inds</code> should be list of first index of next segment</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_kpts" class="doc_header"><code>get_kpts</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L273" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_kpts</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>, <strong><code>skipk</code></strong>=<em><code>0</code></em>, <strong><code>kseg_inds</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<p>Returns kpoints and calculated kpath.</p>
<p>Parameters:</p>
<p>xml_data
    From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function.</p>
<p>skipk : int
    Number of initil kpoints to skip.</p>
<p>kseg_inds : list
    List of indices of kpoints where path is broken.</p>
<p>Returns:</p>
<p>Data : pivotpy.Dict2Data
    with attibutes <code>kpath</code> and <code>kpoints</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_kpts</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">,</span><span class="n">skipk</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Data(
    NKPTS = 126
    kpoints = &lt;ndarray:shape=(126, 3)&gt;
    kpath = &lt;list:len=126&gt;
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_tdos" class="doc_header"><code>get_tdos</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L308" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_tdos</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>, <strong><code>spin_set</code></strong>=<em><code>1</code></em>, <strong><code>elim</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<ul>
<li>Returns total dos for a spin_set (default 1) and energy limit. If spin-polarized calculations, gives SpinUp and SpinDown keys as well.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
<li>spin_set : int, default is 1.and</li>
<li>elim     : List [min,max] of energy, default empty.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>Data     : pivotpy.Dict2Data with attibutes E_Fermi, ISPIN,tdos.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_tdos</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">,</span><span class="n">spin_set</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="p">[])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Data(
    E_Fermi = 3.72526782
    ISPIN = 1
    tdos = &lt;ndarray:shape=(301, 3)&gt;
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_evals" class="doc_header"><code>get_evals</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L360" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_evals</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>, <strong><code>skipk</code></strong>=<em><code>None</code></em>, <strong><code>elim</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<ul>
<li>Returns eigenvalues as numpy array. If spin-polarized calculations, gives SpinUp and SpinDown keys as well.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
<li>skipk    : Number of initil kpoints to skip.</li>
<li>elim     : List [min,max] of energy, default empty.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>Data     : pivotpy.Dict2Data with attibutes evals and related parameters.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_evals</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">,</span><span class="n">skipk</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Data(
    E_Fermi = 3.72526782
    ISPIN = 1
    NBANDS = 7
    evals = &lt;ndarray:shape=(126, 7)&gt;
    indices = range(1, 8)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_bands_pro_set" class="doc_header"><code>get_bands_pro_set</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L414" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_bands_pro_set</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>, <strong><code>spin_set</code></strong>=<em><code>1</code></em>, <strong><code>skipk</code></strong>=<em><code>0</code></em>, <strong><code>bands_range</code></strong>=<em><code>None</code></em>, <strong><code>set_path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns bands projection of a spin_set(default 1). If spin-polarized calculations, gives SpinUp and SpinDown keys as well.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data    : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
<li>skipk       : Number of initil kpoints to skip (Default 0).</li>
<li>spin_set    : Spin set to get, default is 1.</li>
<li>bands_range : If elim used in <a href="/pivotpy/XmlElementTree.html#get_evals"><code>get_evals</code></a>,that will return bands_range to use here. Note that range(0,2) will give 2 bands 0,1 but tuple (0,2) will give 3 bands 0,1,2.</li>
<li>set_path     : path/to/_set[1,2,3,4].txt, works if <a href="/pivotpy/XmlElementTree.html#split_vasprun"><code>split_vasprun</code></a> is used before.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>Data     : pivotpy.Dict2Data with attibutes of bands projections and related parameters.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_bands_pro_set</span><span class="p">(</span><span class="n">xml_data</span><span class="p">,</span><span class="n">skipk</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">spin_set</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">bands_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Data(
    labels = [&#39;s&#39;, &#39;py&#39;, &#39;pz&#39;, &#39;px&#39;, &#39;dxy&#39;, &#39;dyz&#39;, &#39;dz2&#39;, &#39;dxz&#39;, &#39;x2-y2&#39;]
    pros = &lt;ndarray:shape=(2, 136, 1, 9)&gt;
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_dos_pro_set" class="doc_header"><code>get_dos_pro_set</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L509" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_dos_pro_set</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>, <strong><code>spin_set</code></strong>=<em><code>1</code></em>, <strong><code>dos_range</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns dos projection of a spin_set(default 1) as numpy array. If spin-polarized calculations, gives SpinUp and SpinDown keys as well.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data    : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function</li>
<li>spin_set    : Spin set to get, default 1.</li>
<li>dos_range   : If elim used in <a href="/pivotpy/XmlElementTree.html#get_tdos"><code>get_tdos</code></a>,that will return dos_range to use here..</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>Data     : pivotpy.Dict2Data with attibutes of dos projections and related parameters.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_structure" class="doc_header"><code>get_structure</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L550" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_structure</code>(<strong><code>xml_data</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Returns structure's volume,basis,positions and rec-basis.</li>
<li><strong>Parameters</strong><ul>
<li>xml_data : From <a href="/pivotpy/XmlElementTree.html#read_asxml"><code>read_asxml</code></a> function.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>Data     : pivotpy.Dict2Data with attibutes volume,basis,positions rec_basis and labels.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_structure</span><span class="p">(</span><span class="n">xml_data</span><span class="o">=</span><span class="n">xml_data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Data(
    SYSTEM =  AlAs
    volume = 45.73530449
    basis = &lt;ndarray:shape=(3, 3)&gt;
    rec_basis = &lt;ndarray:shape=(3, 3)&gt;
    positions = &lt;ndarray:shape=(2, 3)&gt;
    labels = [&#39;Al 1&#39;, &#39;As 1&#39;]
    unique = Data(
        Al = range(0, 1)
        As = range(1, 2)
    )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Quick-Export-for-Bandstructure">Quick Export for Bandstructure<a class="anchor-link" href="#Quick-Export-for-Bandstructure"> </a></h2><p>A fully comprehensive command that uses all functions and returns data for spin set 1 (set 1 and 2 if spin-polarized calculations) could be constructed for immediate usage. It is <code>export_vasrun()</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="export_vasprun" class="doc_header"><code>export_vasprun</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L591" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>export_vasprun</code>(<strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>skipk</code></strong>=<em><code>None</code></em>, <strong><code>elim</code></strong>=<em><code>[]</code></em>, <strong><code>kseg_inds</code></strong>=<em><code>[]</code></em>, <strong><code>shift_kpath</code></strong>=<em><code>0</code></em>, <strong><code>try_pwsh</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<ul>
<li>Returns a full dictionary of all objects from <code>vasprun.xml</code> file. It first try to load the data exported by powershell's <code>Export-VR(Vasprun)</code>, which is very fast for large files. It is recommended to export large files in powershell first.</li>
<li><strong>Parameters</strong><ul>
<li>path       : Path to <code>vasprun.xml</code> file. Default is <code>'./vasprun.xml'</code>.</li>
<li>skipk      : Default is None. Automatically detects kpoints to skip.</li>
<li>elim       : List [min,max] of energy interval. Default is [], covers all bands.</li>
<li>kseg_inds : List of indices of kpoints where path is broken.</li>
<li>shift_kpath: Default 0. Can be used to merge multiple calculations on single axes side by side.</li>
<li>try_pwsh   : Default is True and tries to load data exported by <code>Vasp2Visual</code> in Powershell.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>Data : Data accessible via dot notation containing nested Data objects:<ul>
<li>sys_info  : System Information</li>
<li>dim_info  : Contains information about dimensions of returned objects.</li>
<li>kpoints   : numpy array of kpoints with excluded IBZKPT points</li>
<li>kpath     : 1D numpy array directly accessible for plot.</li>
<li>bands     : Data containing bands.</li>
<li>tdos      : Data containing total dos.</li>
<li>pro_bands : Data containing bands projections.</li>
<li>pro_dos   : Data containing dos projections.</li>
<li>poscar    : Data containing basis,positions, rec_basis and volume.</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">export_vasprun</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;E:/Research/graphene_example/ISPIN_1/bands/vasprun.xml&#39;</span><span class="p">,</span><span class="n">elim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">try_pwsh</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Data(
    sys_info = Data(
        SYSTEM = C2
        NION = 2
        NELECT = 8
        TypeION = 1
        ElemName = [&#39;C&#39;]
        ElemIndex = [0, 2]
        E_Fermi = -3.35005822
        ISPIN = 1
        fields = [&#39;s&#39;, &#39;py&#39;, &#39;pz&#39;, &#39;px&#39;, &#39;dxy&#39;, &#39;dyz&#39;, &#39;dz2&#39;, &#39;dxz&#39;, &#39;x2-y2&#39;]
        incar = Data(
            SYSTEM = C2
            PREC = high
            ALGO = N
            LSORBIT = T
            NELMIN = 7
            ISMEAR = 0
            SIGMA = 0.10000000
            LORBIT = 11
            KPOINT_BSE = -1     0     0     0
            GGA = PS
        )
    )
    dim_info = Data(
        kpoints = (NKPTS,3)
        kpath = (NKPTS,1)
        bands = ⇅(NKPTS,NBANDS)
        dos = ⇅(grid_size,3)
        pro_dos = ⇅(NION,grid_size,en+pro_fields)
        pro_bands = ⇅(NION,NKPTS,NBANDS,pro_fields)
    )
    kpoints = &lt;ndarray:shape=(90, 3)&gt;
    kpath = &lt;list:len=90&gt;
    bands = Data(
        E_Fermi = -3.35005822
        ISPIN = 1
        NBANDS = 2
        evals = &lt;ndarray:shape=(90, 2)&gt;
        indices = range(6, 8)
    )
    tdos = Data(
        E_Fermi = -3.35005822
        ISPIN = 1
        grid_range = range(156, 164)
        tdos = &lt;ndarray:shape=(8, 3)&gt;
    )
    pro_bands = Data(
        labels = [&#39;s&#39;, &#39;py&#39;, &#39;pz&#39;, &#39;px&#39;, &#39;dxy&#39;, &#39;dyz&#39;, &#39;dz2&#39;, &#39;dxz&#39;, &#39;x2-y2&#39;]
        pros = &lt;ndarray:shape=(2, 90, 2, 9)&gt;
    )
    pro_dos = Data(
        labels = [&#39;energy&#39;, &#39;s&#39;, &#39;py&#39;, &#39;pz&#39;, &#39;px&#39;, &#39;dxy&#39;, &#39;dyz&#39;, &#39;dz2&#39;, &#39;dxz&#39;, &#39;x2-y2&#39;]
        pros = &lt;ndarray:shape=(2, 8, 10)&gt;
    )
    poscar = Data(
        SYSTEM = C2
        volume = 105.49324928
        basis = &lt;ndarray:shape=(3, 3)&gt;
        rec_basis = &lt;ndarray:shape=(3, 3)&gt;
        positions = &lt;ndarray:shape=(2, 3)&gt;
        labels = [&#39;C 1&#39;, &#39;C 2&#39;]
        unique = Data(
            C = range(0, 2)
        )
    )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Joining-Multiple-Calculations">Joining Multiple Calculations<a class="anchor-link" href="#Joining-Multiple-Calculations"> </a></h2><ul>
<li>Sometimes one may need to compare two or more bandstructures in same figure, for that reason, it is easy to export two calculations and plot on same axis.</li>
<li>There is another situation, if you have a large supercell and split calculations into multiple ones, joining that calculations works same way, you will add the last value of first kpath into all values of next kpath and next last to next and so on, by just using <code>shift_kpath</code> in <a href="/pivotpy/XmlElementTree.html#export_vasprun"><code>export_vasprun</code></a> and plot each export on same axis, this will align bandstructures side by side on same axis.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-Exported-Vasprun-from-PowerShell">Load Exported Vasprun from PowerShell<a class="anchor-link" href="#Load-Exported-Vasprun-from-PowerShell"> </a></h2><p>On Windows, it will work automatically. On Linux/Mac it may require path to powershell executable.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_export" class="doc_header"><code>load_export</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L701" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_export</code>(<strong><code>path</code></strong>=<em><code>'./vasprun.xml'</code></em>, <strong><code>kseg_inds</code></strong>=<em><code>[]</code></em>, <strong><code>shift_kpath</code></strong>=<em><code>0</code></em>, <strong><code>path_to_ps</code></strong>=<em><code>'pwsh'</code></em>, <strong><code>skipk</code></strong>=<em><code>None</code></em>, <strong><code>max_filled</code></strong>=<em><code>10</code></em>, <strong><code>max_empty</code></strong>=<em><code>10</code></em>, <strong><code>keep_files</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<ul>
<li>Returns a full dictionary of all objects from <code>vasprun.xml</code> file exported using powershell.</li>
<li><strong>Parameters</strong><ul>
<li>path       : Path to <code>vasprun.xml</code> file. Default is <code>'./vasprun.xml'</code>.</li>
<li>skipk      : Default is None. Automatically detects kpoints to skip.</li>
<li>path_to_ps : Path to <code>powershell.exe</code>. Automatically picks on Windows and Linux if added to PATH.</li>
<li>kseg_inds : List of indices of kpoints where path is broken.</li>
<li>shift_kpath: Default 0. Can be used to merge multiple calculations side by side.</li>
<li>keep_files : Could be use to clean exported text files. Default is True.</li>
<li>max_filled : Number of filled bands below and including VBM. Default is 10.</li>
<li>max_empty  : Number of empty bands above VBM. Default is 10.</li>
</ul>
</li>
<li><strong>Returns</strong><ul>
<li>Data : Data accessible via dot notation containing nested Data objects:<ul>
<li>sys_info  : System Information</li>
<li>dim_info  : Contains information about dimensions of returned objects.</li>
<li>kpoints   : numpy array of kpoints with excluded IBZKPT points</li>
<li>kpath     : 1D numpy array directly accessible for plot.</li>
<li>bands     : Data containing bands.</li>
<li>tdos      : Data containing total dos.</li>
<li>pro_bands : Data containing bands projections.</li>
<li>pro_dos   : Data containing dos projections.</li>
<li>poscar    : Data containing basis,positions, rec_basis and volume.</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This back and forth data transport is required in <a href="https://github.com/massgh/pivotpy-dash">pivotpy-dash</a> app where data is stored in browser in json format, but needs to by python objects for figures.</p>
<h2 id="Write-Clean-data-to-JSON-or-Pickle-file">Write Clean data to JSON or Pickle file<a class="anchor-link" href="#Write-Clean-data-to-JSON-or-Pickle-file"> </a></h2><p>Use <code>dump_vasprun</code> to write output of <a href="/pivotpy/XmlElementTree.html#export_vasprun"><code>export_vasprun</code></a> or <a href="/pivotpy/XmlElementTree.html#load_export"><code>load_export</code></a> to pickle/json file. Pickle is useful for quick load in python while json is useful to transfer data into any language.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dump_dict" class="doc_header"><code>dump_dict</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L854" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dump_dict</code>(<strong><code>dict_data</code></strong>=<em><code>None</code></em>, <strong><code>dump_to</code></strong>=<em><code>'pickle'</code></em>, <strong><code>outfile</code></strong>=<em><code>None</code></em>, <strong><code>indent</code></strong>=<em><code>1</code></em>)</p>
</blockquote>
<ul>
<li>Dump an <a href="/pivotpy/XmlElementTree.html#export_vasprun"><code>export_vasprun</code></a> or <a href="/pivotpy/XmlElementTree.html#load_export"><code>load_export</code></a>'s <code>Data</code> object or any dictionary to json or pickle string/file. It convert <a href="/pivotpy/XmlElementTree.html#Dict2Data"><code>Dict2Data</code></a> to dictionary before serializing to json/pickle, so json/pickle.loads() of converted Data would be a simple dictionary, pass that to <a href="/pivotpy/XmlElementTree.html#Dict2Data"><code>Dict2Data</code></a> to again make accessible via dot notation.</li>
<li><strong>Parameters</strong><ul>
<li>dict_data : Any dictionary/Dict2Data object containg numpy arrays, including <a href="/pivotpy/XmlElementTree.html#export_vasprun"><code>export_vasprun</code></a> or <a href="/pivotpy/XmlElementTree.html#load_export"><code>load_export</code></a> output.</li>
<li>dump_to  : Defualt is <code>pickle</code> or <code>json</code>.</li>
<li>outfile  : Defualt is None and return string. File name does not require extension.</li>
<li>indent   : Defualt is 1. Only works for json.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_from_dump" class="doc_header"><code>load_from_dump</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L884" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_from_dump</code>(<strong><code>file_or_str</code></strong>, <strong><code>keep_as_dict</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<ul>
<li>Loads a json/pickle dumped file or string by auto detecting it.</li>
<li><strong>Parameters</strong><ul>
<li>file_or_str : Filename of pickl/json or their string.</li>
<li>keep_as_dict: Defualt is False and return <code>Data</code> object. If True, returns dictionary.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pivotpy</span> <span class="k">as</span> <span class="nn">pp</span> 
<span class="n">evr</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">export_vasprun</span><span class="p">(</span><span class="s1">&#39;../vasprun.xml&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">dump_dict</span><span class="p">(</span><span class="n">evr</span><span class="o">.</span><span class="n">poscar</span><span class="p">,</span><span class="n">dump_to</span><span class="o">=</span><span class="s1">&#39;pickle&#39;</span><span class="p">)</span>
<span class="c1">#print(s)</span>
<span class="n">load_from_dump</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Data(
    SYSTEM =  AlAs
    volume = 45.73530449
    basis = &lt;ndarray:shape=(3, 3)&gt;
    rec_basis = &lt;ndarray:shape=(3, 3)&gt;
    positions = &lt;ndarray:shape=(2, 3)&gt;
    labels = [&#39;Al 1&#39;, &#39;As 1&#39;]
    unique = Data(
        Al = range(0, 1)
        As = range(1, 2)
    )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Parse-Text-Files-with-Flexibility">Parse Text Files with Flexibility<a class="anchor-link" href="#Parse-Text-Files-with-Flexibility"> </a></h2><ul>
<li>The function <a href="/pivotpy/XmlElementTree.html#islice2array"><code>islice2array</code></a> is used to read text files which have patterns of text and numbers inline, such as EIGENVAL and PROCAR. With all the options of this function, reading and parsing of such files should take a few lines of code only. It can be used to read txt,csv tsv as well with efficent speed.</li>
<li>It reads a file without fully loading into memory and you can still access slices of data in the file. That partial data fetching from file is very handy.  </li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="islice2array" class="doc_header"><code>islice2array</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L914" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>islice2array</code>(<strong><code>path_or_islice</code></strong>, <strong><code>dtype</code></strong>=<em><code>float</code></em>, <strong><code>delimiter</code></strong>=<em><code>'\\s+'</code></em>, <strong><code>include</code></strong>=<em><code>None</code></em>, <strong><code>exclude</code></strong>=<em><code>'#'</code></em>, <strong><code>raw</code></strong>=<em><code>False</code></em>, <strong><code>fix_format</code></strong>=<em><code>True</code></em>, <strong><code>start</code></strong>=<em><code>0</code></em>, <strong><code>nlines</code></strong>=<em><code>None</code></em>, <strong><code>count</code></strong>=<em><code>-1</code></em>, <strong><code>cols</code></strong>=<em><code>None</code></em>, <strong><code>new_shape</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Reads a sliced array from txt,csv type files and return to array. Also manages if columns lengths are not equal and return 1D array. It is faster than loading  whole file into memory. This single function could be used to parse EIGENVAL, PROCAR, DOCAR and similar files with just a combination of <code>exclude, include,start,stop,step</code> arguments.</li>
<li><strong>Parameters</strong><ul>
<li>path_or_islice: Path/to/file or <code>itertools.islice(file_object)</code>. islice is interesting when you want to read different slices of an opened file and do not want to open it again and again. For reference on how to use it just execute <code>pivotpy.export_potential??</code> in a notebook cell or ipython terminal to see how islice is used extensively.</li>
<li>dtype: float by default. Data type of output array, it is must have argument.</li>
<li>start,nlines: The indices of lines to start reading from and number of lines after start respectively. Only work if <code>path_or_islice</code> is a file path. both could be None or int, while start could be a list to read slices from file provided that nlines is int. The spacing between adjacent indices in start should be equal to or greater than nlines as pointer in file do not go back on its own.  These parameters are in output of <a href="/pivotpy/XmlElementTree.html#slice_data"><code>slice_data</code></a><blockquote><p>Note: <code>start</code> should count comments if <code>exclude</code> is None. You can use <a href="/pivotpy/XmlElementTree.html#slice_data"><code>slice_data</code></a> function to get a dictionary of <code>start,nlines, count, cols, new_shape</code> and unpack in argument instead of thinking too much.</p>
</blockquote>
</li>
<li>count: <code>np.size(output_array) = nrows x ncols</code>, if it is known before execution, performance is increased. This parameter is in output of <a href="/pivotpy/XmlElementTree.html#slice_data"><code>slice_data</code></a>.</li>
<li>delimiter:  Default is <code>\s+</code>. Could be any kind of delimiter valid in numpy and in the file.</li>
<li>cols: List of indices of columns to pick. Useful when reading a file like PROCAR which e.g. has text and numbers inline. This parameter is in output of <a href="/pivotpy/XmlElementTree.html#slice_data"><code>slice_data</code></a>.</li>
<li>include: Default is None and includes everything. String of patterns separated by | to keep, could be a regular expression.</li>
<li>exclude: Default is '#' to remove comments. String of patterns separated by | to drop,could be a regular expression.</li>
<li>raw    : Default is False, if True, returns list of raw strings. Useful to select <code>cols</code>.</li>
<li>fix_format: Default is True, it sepearates numbers with poor formatting like 1.000-2.000 to 1.000 2.000 which is useful in PROCAR. Keep it False if want to read string literally.</li>
<li>new_shape : Tuple of shape Default is None. Will try to reshape in this shape, if fails fallbacks to 2D or 1D. This parameter is in output of <a href="/pivotpy/XmlElementTree.html#slice_data"><code>slice_data</code></a>.</li>
</ul>
</li>
<li><strong>Examples</strong><blockquote><p><code>islice2array('path/to/PROCAR',start=3,include='k-point',cols=[3,4,5])[:2]</code>
array([[ 0.125,  0.125,  0.125],
       [ 0.375,  0.125,  0.125]])
<code>islice2array('path/to/EIGENVAL',start=7,exclude='E',cols=[1,2])[:2]</code>
array([[-11.476913,   1.      ],
       [  0.283532,   1.      ]])
Note: Slicing a dimension to 100% of its data is faster than let say 80% for inner dimensions, so if you have to slice more than 50% of an inner dimension, then just load full data and slice after it.</p>
</blockquote>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="slice_data" class="doc_header"><code>slice_data</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L1000" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>slice_data</code>(<strong><code>dim_inds</code></strong>, <strong><code>old_shape</code></strong>)</p>
</blockquote>
<ul>
<li>Returns a dictionary that can be unpacked in arguments of isclice2array function. This function works only for regular txt/csv/tsv data files which have rectangular data written.</li>
<li><strong>Parameters</strong><ul>
<li>dim_inds : List of indices array or range to pick from each dimension. Inner dimensions are more towards right. Last itmes in dim_inds is considered to be columns. If you want to include all values in a dimension, you can put -1 in that dimension. Note that negative indexing does not work in file readig, -1 is s special case to fetch all items.</li>
<li>old_shape: Shape of data set including the columns length in right most place.</li>
</ul>
</li>
<li><strong>Example</strong><ul>
<li>You have data as 3D arry where third dimension is along column.<blockquote><p>0 0
0 2
1 0
1 2</p>
</blockquote>
</li>
<li>To pick [[0,2], [1,2]], you need to give<blockquote><p>slice_data(dim_inds = [[0,1],[1],-1], old_shape=(2,2,2))
{'start': array([1, 3]), 'nlines': 1, 'count': 2}</p>
</blockquote>
</li>
<li>Unpack above dictionary in <a href="/pivotpy/XmlElementTree.html#islice2array"><code>islice2array</code></a> and you will get output array.</li>
</ul>
</li>
<li>Note that dimensions are packed from right to left, like 0,2 is repeating in 2nd column.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slice_data</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span><span class="n">old_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">52</span><span class="p">,</span><span class="mi">768</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;start&#39;: array([ 49152,  98304, 147456, 196608, 245760, 294912]),
 &#39;nlines&#39;: 49152,
 &#39;count&#39;: 294912,
 &#39;cols&#39;: [0, 1],
 &#39;new_shape&#39;: (6, 768, 64, 9)}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Process-Largs-vasprun.xml-Files">Process Largs <code>vasprun.xml</code> Files<a class="anchor-link" href="#Process-Largs-vasprun.xml-Files"> </a></h2><p>You can split a large vasprun.xml file in a small <code>_vasprun.xml</code> file which does not contain projected data, and <code>_set[1,2,3,4].txt</code> file(s) which contain projected data of each spin set. These spin set text files can be processed by <a href="/pivotpy/XmlElementTree.html#islice2array"><code>islice2array</code></a> function efficiently.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_vasprun" class="doc_header"><code>split_vasprun</code><a href="https://github.com/massgh/pivotpy/tree/master/pivotpy/vr_parser.py#L1050" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_vasprun</code>(<strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<ul>
<li>Splits a given vasprun.xml file into a smaller _vasprun.xml file plus _set[1,2,3,4].txt files which contain projected data for each spin set.</li>
<li><strong>Parameters</strong><ul>
<li>path: path/to/vasprun.xml file.</li>
</ul>
</li>
<li><strong>Output</strong><ul>
<li>_vasprun.xml file with projected data.</li>
<li>_set1.txt for projected data of colinear calculation.</li>
<li>_set1.txt for spin up data and _set2.txt for spin-polarized case.</li>
<li>_set[1,2,3,4].txt for each spin set of non-colinear calculations.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">
<p><style>a{text-decoration: none !important;color:lightkblue;font-weight:bold;}
                a:focus,a:active,a:hover{color:hotpink !important;}</style></p>
<blockquote><p><a href="https://massgh.github.io/pivotpy/">&nbsp;<code>▶</code> Index&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/XmlElementTree">&nbsp;<code>▶</code> XmlElementTree●&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/StaticPlots">&nbsp;<code>▶</code> StaticPlots&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/InteractivePlots">&nbsp;<code>▶</code> InteractivePlots&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/Utilities">&nbsp;<code>▶</code> Utilities&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/StructureIO">&nbsp;<code>▶</code> StructureIO&nbsp;</a><br>
<a href="https://massgh.github.io/pivotpy/Widgets">&nbsp;<code>▶</code> Widgets&nbsp;</a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

<script type="application/vnd.jupyter.widget-state+json">
{"state": {"8f1b16f885fa444b8abc19f8fe08f0e4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8ca1ec1952fb4d5da4f289d732a49fd5": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": ["output"], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_8f1b16f885fa444b8abc19f8fe08f0e4", "msg_id": "", "outputs": []}}, "bb8b4d754dd3437dbbd78c12efddb661": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8b836b3871084e9baef99bbab7f2cfa5": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": ["output"], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_bb8b4d754dd3437dbbd78c12efddb661", "msg_id": "", "outputs": []}}}, "version_major": 2, "version_minor": 0}
</script>

